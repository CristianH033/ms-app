import{d as I,r as h,p as M,x as U,h as P,z as G,o as t,c as r,a as v,b as a,w as l,e,A as f,q as H,_ as b,V as $,F as J,i as K,B as p,t as y,j as S,S as O,ap as Q}from"./index-BjlmlwE0.js";import{t as W,z as k,u as X,_ as w,a as V,b as C,c as N,F}from"./FormMessage.vue_vue_type_script_setup_true_lang-lo8LE_9R.js";import{g as Y}from"./sellers-CTvpOThq.js";import{b as Z}from"./raffles-OnuHJqlS.js";import{_ as ee}from"./MoneyInput.vue_vue_type_script_setup_true_lang-CRJI9V7y.js";import{_ as ae,a as le,b as se,c as te,d as oe,e as ne,f as re}from"./SelectScrollDownButton.vue_vue_type_script_setup_true_lang-BN3Xsgzs.js";import{S as q}from"./add-circle-line-duotone-ODTsC-TE.js";const ie=["disabled"],ue={class:"flex flex-row gap-2"},ce={key:0,class:"p-4",value:""},de={style:{position:"relative"}},me={key:0,role:"alert",id:"radix-136-form-item-message",class:"text-sm font-medium text-destructive",type:"error"},_e=v("span",null,"Cancelar",-1),fe=v("span",null,"Asignar",-1),ke=I({__name:"AddSellerToRaffleForm",props:{raffleId:{default:1}},emits:["submit","cancel","success","error"],setup(E,{emit:A}){const B=E,c=A,i=h(!1),d=h([]),D=M(()=>i.value),m=h(null),L=W(k.object({seller_id:k.string({required_error:"El vendedor es requerido"}).refine(s=>{var o;return(o=d.value)==null?void 0:o.some(g=>g.id.toString()===s)},{message:"El vendedor no existe"}),ticket_price:k.string({required_error:"El valor es requerido"}).transform(s=>parseFloat(s)).refine(s=>!isNaN(s)&&s>=1,{message:"El valor debe ser un nÃºmero mayor o igual a 1"})})),{handleSubmit:R}=X({validationSchema:L,initialValues:{}}),T=()=>{c("cancel")},x=R(async s=>{c("submit"),i.value=!0,m.value=null,await Z(B.raffleId,Number(s.seller_id),Number(s.ticket_price)).then(o=>{c("success"),console.log(o)}).catch(o=>{c("error"),console.error(o),m.value=o.message}).finally(()=>{i.value=!1})},({errors:s})=>{console.log(s)}),j=async()=>{i.value=!0,Y().then(s=>{d.value=s}).catch(s=>{console.error(s)}).finally(()=>{i.value=!1})};return U(async()=>{await j()}),(s,o)=>{const g=P("RouterLink"),_=G("auto-animate");return t(),r("form",{onSubmit:o[0]||(o[0]=Q((...u)=>e(x)&&e(x)(...u),["prevent"]))},[v("fieldset",{disabled:D.value},[a(e(F),{name:"seller_id"},{default:l(({componentField:u})=>[a(e(w),null,{default:l(()=>[a(e(V),null,{default:l(()=>[f("Vendedor")]),_:1}),a(e(ae),H(u,{required:""}),{default:l(()=>[a(e(C),null,{default:l(()=>[v("div",ue,[a(e(le),null,{default:l(()=>[a(e(se),{placeholder:"Elige un vendedor"})]),_:1}),a(g,{to:{name:"sellers"}},{default:l(({navigate:n})=>[a(e(b),{variant:"outline",type:"button",onClick:n},{default:l(()=>[a(e(q),{class:"w-6 h-6"})]),_:2},1032,["onClick"])]),_:1})])]),_:1}),a(e(te),null,{default:l(()=>[a(e(oe),null,{default:l(()=>[a(e(ne),null,{default:l(()=>[f("Vendedores")]),_:1}),d.value.length===0?(t(),r("div",ce,"No hay vendedores")):$("",!0),(t(!0),r(J,null,K(d.value,n=>(t(),S(e(re),{key:n.id,value:n.id.toString()},{default:l(()=>[f(y(n.name)+" - "+y(n.phone),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040),p((t(),r("div",null,[a(e(N))])),[[_]])]),_:2},1024)]),_:1}),a(e(F),{name:"ticket_price"},{default:l(({value:u,handleChange:n})=>[a(e(w),null,{default:l(()=>[a(e(V),null,{default:l(()=>[f("Establezca el valor del bono para el vendedor")]),_:1}),a(e(C),null,{default:l(()=>[a(ee,{"model-value":u,"onUpdate:modelValue":z=>n(z,!0),required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),p((t(),r("div",null,[a(e(N))])),[[_]])]),_:2},1024)]),_:1}),p((t(),r("div",de,[m.value!==null?(t(),r("p",me,y(m.value),1)):$("",!0)])),[[_]]),a(e(w),{class:"space-y-0 w-full py-2 flex flex-col-reverse md:flex-row items-center justify-end gap-2"},{default:l(()=>[a(e(b),{type:"button",class:"w-full gap-2",variant:"outline",onClick:T},{default:l(()=>[_e]),_:1}),a(e(b),{type:"submit",class:"w-full gap-2"},{default:l(()=>[p((t(),r("div",null,[i.value?(t(),S(e(O),{key:0,class:"h-6 w-6"})):(t(),S(e(q),{key:1,class:"w-6 h-6"}))])),[[_]]),fe]),_:1})]),_:1})],8,ie)],32)}}});export{ke as _};
