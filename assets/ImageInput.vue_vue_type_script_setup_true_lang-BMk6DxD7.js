import{M as _,a_ as T,m as D,o as b,c as p,a as i,d as R,ay as y,r as v,az as B,a9 as H,q as M,Y as F,S,v as L,n as N,e as w,C as z,U as A,b as E,N as P}from"./index-BXzmiJAW.js";import{f as j}from"./thumbHash-Ci89Ad7b.js";var n=[];for(var g=0;g<256;++g)n.push((g+256).toString(16).slice(1));function q(e,a=0){return(n[e[a+0]]+n[e[a+1]]+n[e[a+2]]+n[e[a+3]]+"-"+n[e[a+4]]+n[e[a+5]]+"-"+n[e[a+6]]+n[e[a+7]]+"-"+n[e[a+8]]+n[e[a+9]]+"-"+n[e[a+10]]+n[e[a+11]]+n[e[a+12]]+n[e[a+13]]+n[e[a+14]]+n[e[a+15]]).toLowerCase()}var m,$=new Uint8Array(16);function O(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m($)}var Y=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const x={randomUUID:Y};function G(e,a,t){if(x.randomUUID&&!a&&!e)return x.randomUUID();e=e||{};var o=e.random||(e.rng||O)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,q(o)}const J=async e=>new Promise((a,t)=>{const o=new FileReader;o.onloadend=()=>{typeof o.result=="string"?a(o.result):t(new Error("Failed to convert to base64"))},o.onerror=t,o.readAsDataURL(e)}),ne=async(e,a,t="")=>{a=G().slice(-10)+"-"+a;const{data:l,error:r}=await _.storage.from(t).upload(a,e,{cacheControl:"3600",upsert:!1});return r&&console.log(r),l},K=async(e,a="")=>{const{data:t,error:o}=await _.storage.from(a).download(e);return o&&console.log(o),t},se=T(async(e,a="")=>{const t=await K(e,a);return await J(t)}),Q={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function W(e,a){return b(),p("svg",Q,a[0]||(a[0]=[i("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[i("circle",{cx:"12",cy:"12",r:"10",opacity:".5"}),i("path",{"stroke-linecap":"round",d:"m14.5 9.5l-5 5m0-5l5 5"})],-1)]))}const X=D({name:"solar-close-circle-line-duotone",render:W}),Z={key:0,class:"relative h-full w-full overflow-hidden rounded-md rounded-b-none border border-b-0 p-3"},ee=["src"],ae=["name"],le=R({__name:"ImageInput",props:y({label:{},defaultValue:{},modelValue:{},class:{},name:{},accept:{},initialImage:{}},{base64ThumbHash:{required:!1},base64ThumbHashModifiers:{}}),emits:y(["update:modelValue","touched"],["update:base64ThumbHash"]),setup(e,{emit:a}){const t=v(null),o=v(null),l=e,r=B(e,"base64ThumbHash");let u=l.initialImage;const c=v(!1),f=a,U=H(l,"modelValue",f,{passive:!0,defaultValue:l.defaultValue}),V=async s=>{var h;c.value=!0;const d=(h=s.target.files)==null?void 0:h[0];d?(t.value=URL.createObjectURL(d),r.value=await j(d)):r.value=null},k=()=>{c.value=!0,t.value=null,U.value="",u=void 0,r.value=null,o.value&&(o.value.files=null,o.value.value="")},C=()=>{c.value||u!==void 0&&(typeof u=="string"&&(t.value=u),u instanceof Promise&&u.then(s=>{typeof s=="string"&&(t.value=s)}))};return M(()=>{C()}),F(c,s=>{s&&f("touched",null)}),(s,I)=>{const d=S("auto-animate");return b(),p("div",null,[L(s.$slots,"preview",{},()=>[A((b(),p("div",null,[t.value?(b(),p("div",Z,[i("button",{type:"button",onClick:k,class:"absolute right-1 top-1 rounded-full border bg-background-elevated/50 p-1 backdrop-blur disabled:cursor-not-allowed disabled:opacity-50"},[E(w(X),{class:"h-5 w-5"})]),i("img",{src:t.value,class:"max-h-32 min-h-32 rounded-3xs border object-cover"},null,8,ee)])):P("",!0)])),[[d]])]),i("input",{class:N(w(z)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t.value?"rounded-t-none":"rounded-md",l.class)),name:l.name,type:"file",accept:"image/*",onChange:V,ref_key:"input",ref:o},null,42,ae)])}}});export{le as _,se as g,ne as u,G as v};
