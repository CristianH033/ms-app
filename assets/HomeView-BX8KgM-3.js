import{_ as Ae}from"./RafflesList.vue_vue_type_script_setup_true_lang-uyEl2uPl.js";import{S as J,_ as Ce,a as Se,b as Pe,c as Be,d as Ie}from"./AlertDialogDescription.vue_vue_type_script_setup_true_lang-Ctl7R1fG.js";import{c as Oe,g as He}from"./raffles-PJp0gFbQ.js";import{d as x,o as l,c as v,l as F,e,n as le,p as N,s as ne,m as je,a as p,q as Ge,v as C,x as We,y as Ke,z as B,A as re,j as _,w as t,b as a,i as K,F as Z,B as w,C as Ze,D as b,t as Q,E as j,M as Xe,G as ie,H as Ye,I as Je,J as ee,K as se,L as Qe,N as ea,O as aa,V as ta,P as sa,Q as la,S as oa,U as na,W as ra,X as ia,Y as da,Z as ua,r as U,$ as ca,a0 as fa,a1 as de,a2 as ue,_ as H,a3 as _e,a4 as ma,a5 as pa,a6 as ce,a7 as Fe,a8 as _a,a9 as he,aa as ha,ab as oe,ac as va,ad as ga}from"./index-_SyS5VNF.js";import{u as ba,t as Ve,z as P,a as ze,_ as E,b as L,c as R,d as M,F as T}from"./vee-validate-zod.esm-CCVB3W0g.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-BD_WEcCY.js";import{v as ve,u as ya}from"./storage-SD6hIaVl.js";import{S as wa}from"./cup-star-line-duotone-BcDN8BdA.js";import{_ as ge}from"./ImageInput.vue_vue_type_script_setup_true_lang-DQt78TDG.js";import{_ as De,a as Ee,b as Ne,c as qe,d as Le,e as Re,f as Me,g as be}from"./SelectScrollDownButton.vue_vue_type_script_setup_true_lang-By716g0o.js";import{_ as Te}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-il5MzxJO.js";import{c as fe}from"./createLucideIcon-DyDJ4BWo.js";import{S as xa}from"./magnifer-outline-CCi7kegb.js";import{S as $a}from"./ticket-line-duotone-CqRuteJi.js";import{_ as ka,a as Ca}from"./AlertDialogCancel.vue_vue_type_script_setup_true_lang-CqwjD4-m.js";import"./user-speak-line-duotone-Owc2JreP.js";import"./LazyImg-CYTZ4Rs5.js";import"./thumbHash-Ci89Ad7b.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-DqrlsmgW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./CardContent.vue_vue_type_script_setup_true_lang-DL24nGq_.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-BEM8dPQv.js";const Sa=fe("CalendarIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const Pa=fe("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Ba=fe("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Fa=["id"],ye=x({__name:"FormDescription",props:{class:{}},setup(i){const s=i,{formDescriptionId:n}=ba();return(c,r)=>(l(),v("p",{id:e(n),class:le(e(N)("text-sm text-muted-foreground",s.class))},[F(c.$slots,"default")],10,Fa))}}),we=async()=>{const{data:i,error:s}=await ne.from("draws").select("*");if(s)throw new Error(s.message);return i},Va=async i=>{const{data:s,error:n}=await ne.from("draws").insert(i).select().single();if(n)throw new Error(n.message);return s},za={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Da=p("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[p("path",{d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.535 1.464C22 4.93 22 7.286 22 12s0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z",opacity:".5"}),p("path",{"stroke-linecap":"round",d:"m14.5 9.5l-5 5m0-5l5 5"})],-1),Ea=[Da];function Na(i,s){return l(),v("svg",za,[...Ea])}const qa=je({name:"solar-close-square-line-duotone",render:Na}),La=x({__name:"Textarea",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(i,{emit:s}){const n=i,r=Ge(n,"modelValue",s,{passive:!0,defaultValue:n.defaultValue});return(d,u)=>C((l(),v("textarea",{"onUpdate:modelValue":u[0]||(u[0]=V=>Ke(r)?r.value=V:null),class:le(e(N)("flex min-h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n.class))},null,2)),[[We,e(r)]])}}),Ra={class:"flex flex-col gap-y-4 mt-4 sm:flex-row sm:gap-x-4 sm:gap-y-0"},Ma=x({__name:"Calendar",props:{modelValue:{},multiple:{type:Boolean},defaultValue:{},defaultPlaceholder:{},placeholder:{},pagedNavigation:{type:Boolean},preventDeselect:{type:Boolean},weekStartsOn:{},weekdayFormat:{},calendarLabel:{},fixedWeeks:{type:Boolean},maxValue:{},minValue:{},locale:{},numberOfMonths:{},disabled:{type:Boolean},readonly:{type:Boolean},initialFocus:{type:Boolean},isDateDisabled:{type:Function},isDateUnavailable:{type:Function},dir:{},nextPage:{type:Function},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:placeholder"],setup(i,{emit:s}){const n=i,c=s,r=B(()=>{const{class:u,...V}=n;return V}),d=re(r,c);return(u,V)=>(l(),_(e(Ze),w({class:e(N)("p-3",n.class)},e(d)),{default:t(({grid:W,weekDays:O})=>[a(e(ja),null,{default:t(()=>[a(e(Ka)),a(e(Ga)),a(e(Wa))]),_:1}),p("div",Ra,[(l(!0),v(Z,null,K(W,A=>(l(),_(e(Aa),{key:A.value.toString()},{default:t(()=>[a(e(Oa),null,{default:t(()=>[a(e(xe),null,{default:t(()=>[(l(!0),v(Z,null,K(O,z=>(l(),_(e(Ha),{key:z},{default:t(()=>[b(Q(z),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a(e(Ia),null,{default:t(()=>[(l(!0),v(Z,null,K(A.rows,(z,$)=>(l(),_(e(xe),{key:`weekDate-${$}`,class:"mt-2 w-full"},{default:t(()=>[(l(!0),v(Z,null,K(z,k=>(l(),_(e(Ta),{key:k.toString(),date:k},{default:t(()=>[a(e(Ua),{day:k,month:A.value},null,8,["day","month"])]),_:2},1032,["date"]))),128))]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},16,["class"]))}}),Ta=x({__name:"CalendarCell",props:{date:{},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(Xe),w({class:e(N)("relative h-9 w-9 p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([data-selected])]:rounded-md [&:has([data-selected])]:bg-accent [&:has([data-selected][data-outside-view])]:bg-accent/50",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ua=x({__name:"CalendarCellTrigger",props:{day:{},month:{},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(Ye),w({class:e(N)(e(ie)({variant:"ghost"}),"h-9 w-9 p-0 font-normal","[&[data-today]:not([data-selected])]:bg-accent [&[data-today]:not([data-selected])]:text-accent-foreground","data-[selected]:bg-primary data-[selected]:text-primary-foreground data-[selected]:opacity-100 data-[selected]:hover:bg-primary data-[selected]:hover:text-primary-foreground data-[selected]:focus:bg-primary data-[selected]:focus:text-primary-foreground","data-[disabled]:text-muted-foreground data-[disabled]:opacity-50","data-[unavailable]:text-destructive-foreground data-[unavailable]:line-through","data-[outside-view]:text-muted-foreground data-[outside-view]:opacity-50 [&[data-outside-view][data-selected]]:bg-accent/50 [&[data-outside-view][data-selected]]:text-muted-foreground [&[data-outside-view][data-selected]]:opacity-30",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Aa=x({__name:"CalendarGrid",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(Je),w({class:e(N)("w-full border-collapse space-y-1",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ia=x({__name:"CalendarGridBody",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(n,c)=>(l(),_(e(Qe),ee(se(s)),{default:t(()=>[F(n.$slots,"default")]),_:3},16))}}),Oa=x({__name:"CalendarGridHead",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(n,c)=>(l(),_(e(ea),ee(se(s)),{default:t(()=>[F(n.$slots,"default")]),_:3},16))}}),xe=x({__name:"CalendarGridRow",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(aa),w({class:e(N)("flex",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ha=x({__name:"CalendarHeadCell",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(ta),w({class:e(N)("w-9 rounded-md text-[0.8rem] font-normal text-muted-foreground",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),ja=x({__name:"CalendarHeader",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(sa),w({class:e(N)("relative flex w-full items-center justify-between pt-1",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ga=x({__name:"CalendarHeading",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(la),w({class:e(N)("text-sm font-medium",s.class)},e(c)),{default:t(({headingValue:u})=>[F(r.$slots,"default",{headingValue:u},()=>[b(Q(u),1)])]),_:3},16,["class"]))}}),Wa=x({__name:"CalendarNextButton",props:{step:{},nextPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(oa),w({class:e(N)(e(ie)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default",{},()=>[a(e(Ba),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ka=x({__name:"CalendarPrevButton",props:{step:{},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,n=B(()=>{const{class:r,...d}=s;return d}),c=j(n);return(r,d)=>(l(),_(e(na),w({class:e(N)(e(ie)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default",{},()=>[a(e(Pa),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Za=x({__name:"Popover",props:{defaultOpen:{type:Boolean},open:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(i,{emit:s}){const r=re(i,s);return(d,u)=>(l(),_(e(ra),ee(se(e(r))),{default:t(()=>[F(d.$slots,"default")]),_:3},16))}}),Xa=x({__name:"PopoverTrigger",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(n,c)=>(l(),_(e(ia),ee(se(s)),{default:t(()=>[F(n.$slots,"default")]),_:3},16))}}),Ya=x({inheritAttrs:!1,__name:"PopoverContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},side:{},sideOffset:{default:4},align:{default:"center"},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(i,{emit:s}){const n=i,c=s,r=B(()=>{const{class:u,...V}=n;return V}),d=re(r,c);return(u,V)=>(l(),_(e(ua),null,{default:t(()=>[a(e(da),w({...e(d),...u.$attrs},{class:e(N)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n.class)}),{default:t(()=>[F(u.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Ja=async()=>{const{data:i,error:s}=await ne.from("lotteries").select("*");if(s)throw new Error(s.message);return i},Qa=["aria-disabled"],et=["disabled"],at=p("input",{hidden:""},null,-1),tt=p("span",null,"Cancelar",-1),st=p("span",null,"Crear",-1),lt=x({__name:"DrawForm",emits:["submit","success","error","cancel"],setup(i,{emit:s}){const n=U("idle"),c=U([]),r=s,d=B(()=>n.value==="pending"),u=B(()=>n.value==="pending"||d.value),V=new ca("es-CO",{dateStyle:"long"}),W=Ve(P.object({lottery_id:P.string({required_error:"Lotería es requerida"}).refine(y=>{var S;return(S=c.value)==null?void 0:S.some(G=>G.id.toString()===y)},{message:"El Sorteo no existe"}),name:P.string().refine(y=>y,{message:"La descripción es requerida"}),drawn_at:P.string().refine(y=>y,{message:"La fecha es requerida"})})),{handleSubmit:O,setFieldValue:A,values:z}=ze({validationSchema:W,initialValues:{}}),$=B({get:()=>z.drawn_at?_a(z.drawn_at):void 0,set:y=>y}),k=()=>{Ja().then(y=>{c.value=y}).catch(y=>{console.error(y)}).finally(()=>{})},X=O(y=>{n.value="pending",Va({...y,lottery_id:parseInt(y.lottery_id)}).then(async S=>{n.value="success",r("success",S==null?void 0:S.id)}).catch(()=>{n.value="error"}).finally(()=>{setTimeout(()=>{n.value="idle"},1e3)})}),I=()=>{r("cancel")};return fa($,y=>{y&&(!z.name||z.name.startsWith("Sorteo del "))&&A("name",`Sorteo del ${V.format(_e(y))}`)}),de(async()=>{k()}),(y,S)=>{const G=ue("auto-animate");return l(),v("form",{onSubmit:S[2]||(S[2]=Fe((...D)=>e(X)&&e(X)(...D),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":u.value},[p("fieldset",{disabled:u.value},[a(e(T),{name:"lottery_id"},{default:t(({componentField:D})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Lotería")]),_:1}),a(e(De),ee(se(D)),{default:t(()=>[a(e(R),null,{default:t(()=>[a(e(Ee),null,{default:t(()=>[a(e(Ne),{placeholder:"Elige una loteria"})]),_:1})]),_:1}),a(e(qe),null,{default:t(()=>[a(e(Le),null,{default:t(()=>[a(e(Re),null,{default:t(()=>[b("Loterías")]),_:1}),(l(!0),v(Z,null,K(c.value,Y=>(l(),_(e(Me),{key:Y.id,value:Y.id.toString()},{default:t(()=>[b(Q(Y.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040),C((l(),v("div",null,[a(e(M))])),[[G]])]),_:2},1024)]),_:1}),a(e(T),{name:"name"},{default:t(({componentField:D})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Descripción del sorteo")]),_:1}),a(e(R),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Descripción corta del sorteo"},D,{required:""}),null,16)]),_:2},1024),a(e(ye),null,{default:t(()=>[b(' Descripción corta del sorteo, e.j. "Sorteo del 10 de Mayo de 2024". ')]),_:1}),C((l(),v("div",null,[a(e(M))])),[[G]])]),_:2},1024)]),_:1}),a(e(T),{name:"drawn_at"},{default:t(()=>[a(e(E),{class:"flex flex-col"},{default:t(()=>[a(e(L),null,{default:t(()=>[b("Fecha del sorteo")]),_:1}),a(e(Za),null,{default:t(()=>[a(e(Xa),{"as-child":""},{default:t(()=>[a(e(R),null,{default:t(()=>[a(e(H),{variant:"outline",class:le(e(N)("w-full ps-3 text-start font-normal",!$.value&&"text-muted-foreground"))},{default:t(()=>[p("span",null,Q($.value?e(V).format(e(_e)($.value)):"Seleccione una fecha"),1),a(e(Sa),{class:"ms-auto h-4 w-4 opacity-50"})]),_:1},8,["class"]),at]),_:1})]),_:1}),a(e(Ya),{class:"w-auto p-0"},{default:t(()=>[a(e(Ma),{modelValue:$.value,"onUpdate:modelValue":[S[0]||(S[0]=D=>$.value=D),S[1]||(S[1]=D=>{D?e(A)("drawn_at",D.toString()):e(A)("drawn_at",void 0)})],"calendar-label":"Date of birth","initial-focus":"","min-value":e(ma)(e(pa)())},null,8,["modelValue","min-value"])]),_:1})]),_:1}),a(e(ye),null,{default:t(()=>[b(" Fecha del sorteo. ")]),_:1}),C((l(),v("div",null,[a(e(M))])),[[G]])]),_:1})]),_:1}),a(e(E),{class:"flex w-full flex-col-reverse items-center justify-end gap-2 space-y-0 py-2 md:flex-row"},{default:t(()=>[a(e(H),{type:"button",class:"w-full gap-2 @xl/form:w-auto",variant:"outline",onClick:I},{default:t(()=>[tt]),_:1}),C((l(),_(e(H),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[d.value?(l(),_(e(ce),{key:0,class:"h-6 w-6"})):(l(),_(e(J),{key:1,class:"h-6 w-6"})),st]),_:1})),[[G]])]),_:1})],8,et)],40,Qa)}}}),ot=["aria-disabled"],nt=["disabled"],rt={class:"flex flex-row gap-2"},it={key:0,class:"p-4",value:""},dt={class:"grid gap-4 sm:grid-cols-2 sm:gap-6"},ut={class:"col-span-2 flex flex-col gap-4 rounded-md border p-4"},ct={class:"flex gap-2 text-lg font-medium"},ft=p("span",null,"Premios",-1),mt=["onClick"],pt={class:"w-full rounded-md border p-4"},_t={class:"text-lg font-medium"},ht={class:"flex w-full flex-row items-center justify-end py-2"},vt=p("span",null,"Agregar premio",-1),gt=p("span",null,"Crear",-1),$e=1,ke=5e6,bt=x({__name:"RaffleForm",props:he({withoutActions:{type:[Boolean,String],default:!1}},{isSubmiting:{type:Boolean,required:!1,default:!1},isSubmitingModifiers:{}}),emits:he(["success"],["update:isSubmiting"]),setup(i,{emit:s}){const n=["image/jpeg","image/jpg","image/png","image/webp"],c=i,r=ha(i,"isSubmiting"),d=U([]),u=U({draw_id:void 0,name:"",description:"",image_path:null,thumb_hash:null,number_of_tickets:1e3,ticket_price:"",prizes:[{key:ve().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null}]}),V=P.object({draw_id:P.string({required_error:"Sorteo es requerido"}).refine(async o=>{var f;return(f=await we())==null?void 0:f.some(h=>h.id.toString()===o)},{message:"El Sorteo no existe"}),name:P.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),description:P.string({required_error:"La descripción es requerida"}).min(3,{message:"La descripción debe tener al menos 3 caracteres"}).optional(),number_of_tickets:P.number({required_error:"El numero de tickets es requerido"}).min(100,{message:"El numero de tickets debe ser mayor o igual a 100"}),ticket_price:P.string({required_error:"El valor es requerido"}).transform(o=>parseFloat(o)).refine(o=>!isNaN(o)&&o>=1,{message:"El valor debe ser un número mayor o igual a 1"}),prizes:P.array(P.object({name:P.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),prize_value:P.string({required_error:"El valor es requerido"}).transform(o=>parseFloat(o)).refine(o=>!isNaN(o)&&o>=1,{message:"El valor debe ser un número mayor o igual a 1"}),image:P.instanceof(File).refine(o=>o instanceof File,{message:"Debe seleccionar una imagen"}).refine(o=>n.includes(o.type),{message:"Tipo de archivo no aceptado"}).refine(o=>o.size>=$e,{message:"El archivo está vacío"}).refine(o=>o.size<=ke,{message:"El archivo es demasiado grande"})})).min(1),image:P.instanceof(File).refine(o=>o instanceof File,{message:"Debe seleccionar una imagen"}).refine(o=>n.includes(o.type),{message:"Tipo de archivo no aceptado"}).refine(o=>o.size>=$e,{message:"El archivo está vació"}).refine(o=>o.size<=ke,{message:"El archivo es demasiado grande"})}),W=Ve(V),O=ze({validationSchema:W,initialValues:{number_of_tickets:u.value.number_of_tickets}}),A=s,z=()=>{u.value.prizes.push({key:ve().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null})},$=o=>{u.value.prizes.length>1&&u.value.prizes.find(h=>h.key===o)&&(u.value.prizes=u.value.prizes.filter(h=>h.key!==o))},k=async o=>{const f=await ya(o,o.name,"covers");return f==null?void 0:f.fullPath},X=o=>new Promise((f,h)=>{k(o.image).then(m=>{f({draw_id:parseInt(o.draw_id),name:o.name,description:o.description,image_path:m,thumb_hash:u.value.thumb_hash,number_of_tickets:o.number_of_tickets,ticket_price:o.ticket_price})}).catch(m=>{h(m)})}),I=o=>Promise.all(o.prizes.map((f,h)=>new Promise((m,g)=>{k(f.image).then(q=>{m({name:f.name,prize_value:f.prize_value,image_path:q,thumb_hash:u.value.prizes[h].thumb_hash})}).catch(q=>{g(q)})}))),y=o=>new Promise((f,h)=>{X(o).then(m=>{I(o).then(g=>{f({...m,prizes:g})}).catch(g=>{h(g)})}).catch(m=>{h(m)})}),S=O.handleSubmit(async o=>{r.value=!0,O.setErrors({}),r.value=!1;const f=await y(o);Oe(f).then(()=>{A("success")}).catch(h=>{console.error(h)}).finally(()=>{r.value=!1})},({errors:o})=>{const f=Object.keys(o)[0].replace("[",".").replace("]",""),h=document.querySelector(`[name="${f}"]`);h&&h.scrollIntoView({behavior:"smooth",block:"center"})}),G=B(()=>c.withoutActions===""||c.withoutActions===!0),D=U(!1),Y=()=>{D.value=!1},Ue=async o=>{Y(),await me(),va(()=>{u.value.draw_id=o.toString(),O.setFieldValue("draw_id",o.toString()),O.setFieldTouched("draw_id",!0)})},me=async()=>{r.value=!0,await we().then(o=>d.value=o).finally(()=>r.value=!1)};return de(async()=>{await me()}),(o,f)=>{const h=ue("auto-animate");return l(),v("form",{onSubmit:f[6]||(f[6]=Fe((...m)=>e(S)&&e(S)(...m),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":r.value},[p("fieldset",{disabled:r.value},[a(e(T),{name:"name"},{default:t(({componentField:m})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Nombre")]),_:1}),a(e(R),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre de la Rifa"},m,{"model-value":u.value.name,"onUpdate:modelValue":f[0]||(f[0]=g=>u.value.name=g),required:""}),null,16,["model-value"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(T),{name:"draw_id"},{default:t(({componentField:m})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Sorteo")]),_:1}),a(e(De),w(m,{"model-value":u.value.draw_id,"onUpdate:modelValue":f[2]||(f[2]=g=>u.value.draw_id=g)}),{default:t(()=>[a(e(R),null,{default:t(()=>[p("div",rt,[a(e(Ee),null,{default:t(()=>[a(e(Ne),{placeholder:"Elige un sorteo"})]),_:1}),a(e(Ce),{open:D.value,"onUpdate:open":f[1]||(f[1]=g=>D.value=g)},{default:t(()=>[a(e(Te),{"as-child":""},{default:t(()=>[a(e(H),{variant:"outline",type:"button"},{default:t(()=>[a(e(J),{class:"h-6 w-6"})]),_:1})]),_:1}),a(e(Se),null,{default:t(()=>[a(e(Pe),null,{default:t(()=>[a(e(Be),null,{default:t(()=>[b("Crear nuevo sorteo")]),_:1}),a(lt,{onSuccess:Ue,onCancel:Y})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1}),a(e(qe),null,{default:t(()=>[a(e(Le),null,{default:t(()=>[a(e(Re),null,{default:t(()=>[b("Sorteos")]),_:1}),d.value.length===0?(l(),v("div",it,"No hay sorteos")):oe("",!0),(l(!0),v(Z,null,K(d.value,g=>(l(),_(e(Me),{key:g.id,value:g.id.toString()},{default:t(()=>[b(Q(g.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040,["model-value"]),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(T),{name:"description"},{default:t(({componentField:m})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Descripción")]),_:1}),a(e(R),null,{default:t(()=>[a(e(La),w({type:"text",placeholder:"Descripción de la Rifa"},m,{"model-value":u.value.description,"onUpdate:modelValue":f[3]||(f[3]=g=>u.value.description=g)}),null,16,["model-value"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(T),{name:"number_of_tickets"},{default:t(({componentField:m})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Número de Bonos:")]),_:1}),a(e(R),null,{default:t(()=>[a(e(te),w({type:"number",inputmode:"numeric",placeholder:"Nombre de la Rifa"},m,{"model-value":u.value.number_of_tickets,"onUpdate:modelValue":f[4]||(f[4]=g=>u.value.number_of_tickets=g),required:""}),null,16,["model-value"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(T),{name:"ticket_price"},{default:t(({value:m,handleChange:g})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Costo del Bono")]),_:1}),a(e(R),null,{default:t(()=>[a(be,{"model-value":m,"onUpdate:modelValue":q=>{g(q,!0),u.value.ticket_price=q.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(T),{name:"image"},{default:t(({componentField:m})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Portada de la rifa")]),_:1}),a(e(R),null,{default:t(()=>[a(ge,w(m,{base64ThumbHash:u.value.thumb_hash,"onUpdate:base64ThumbHash":f[5]||(f[5]=g=>u.value.thumb_hash=g)}),null,16,["base64ThumbHash"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),p("div",dt,[C((l(),v("fieldset",ut,[p("legend",ct,[a(e(wa),{class:"h-8 w-8"}),ft]),(l(!0),v(Z,null,K(u.value.prizes,(m,g)=>(l(),v("div",{class:"relative w-full",key:m.key},[u.value.prizes.length>1?(l(),v("button",{key:0,type:"button",class:"absolute right-0 top-0 rounded-xl bg-background",onClick:q=>$(m.key)},[a(e(qa),{class:"h-8 w-8"})],8,mt)):oe("",!0),p("fieldset",pt,[p("legend",_t,"Premio "+Q(g+1),1),a(e(T),{name:"prizes."+g+".name"},{default:t(({componentField:q})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Nombre")]),_:1}),a(e(R),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre del premio",ref_for:!0},q,{"model-value":m.name,"onUpdate:modelValue":ae=>m.name=ae,required:""}),null,16,["model-value","onUpdate:modelValue"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(T),{name:"prizes."+g+".prize_value"},{default:t(({value:q,handleChange:ae})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Valor del premio")]),_:1}),a(e(R),null,{default:t(()=>[a(be,{"model-value":q,"onUpdate:modelValue":pe=>{ae(pe,!0),m.prize_value=pe.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(T),{name:"prizes."+g+".image"},{default:t(({componentField:q})=>[a(e(E),null,{default:t(()=>[a(e(L),null,{default:t(()=>[b("Imagen")]),_:1}),a(e(R),null,{default:t(()=>[a(ge,w({ref_for:!0},q,{base64ThumbHash:m.thumb_hash,"onUpdate:base64ThumbHash":ae=>m.thumb_hash=ae}),null,16,["base64ThumbHash","onUpdate:base64ThumbHash"])]),_:2},1024),C((l(),v("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"])])]))),128)),p("div",ht,[a(e(H),{variant:"outline",type:"button",class:"w-full gap-2 @xl/form:w-auto",onClick:z},{default:t(()=>[a(e(J),{class:"h-6 w-6"}),vt]),_:1})])])),[[h]])]),G.value?oe("",!0):F(o.$slots,"actions",ee(w({key:0},{isSubmiting:r.value})),()=>[a(e(E),{class:"flex w-full flex-row items-center justify-end py-2"},{default:t(()=>[C((l(),_(e(H),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[r.value?(l(),_(e(ce),{key:0,class:"h-6 w-6"})):(l(),_(e(J),{key:1,class:"h-6 w-6"})),gt]),_:1})),[[h]])]),_:1})])],8,nt)],40,ot)}}}),yt={class:"flex w-full flex-col items-center"},wt={class:"flex w-full max-w-3xl flex-col gap-4"},xt={class:"relative grow"},$t=p("span",{class:"hidden md:inline"},"Nueva rifa",-1),kt={class:"flex flex-row items-center justify-start gap-2"},Ct=p("span",null," Nueva Rifa ",-1),St={class:"relative overflow-y-auto px-6 py-4"},Pt=p("span",null,"Crear",-1),Bt={class:"flex w-full flex-col items-center gap-4"},Ft=p("div",{class:"flex w-full flex-col items-center"},null,-1),Jt=x({__name:"HomeView",setup(i){const s=U(!1),n=U(!1),c=U(""),r=U([]),d=U(!1),u=U(!1),V=U(null),W=B(()=>r.value.filter($=>$.raffle_name.toLowerCase().includes(c.value.toLowerCase())));ga(V,([{isIntersecting:$}])=>{u.value=!$},{rootMargin:"-65px",threshold:1});const O=()=>{d.value=!1},A=async()=>{O(),await z()},z=async()=>{s.value=!0,await He().then($=>{r.value=$}).catch($=>{console.log($)}).finally(()=>{s.value=!1})};return de(async()=>{await z()}),($,k)=>{const X=ue("auto-animate");return l(),v("div",yt,[p("div",{ref_key:"sentinal",ref:V,class:"h-0 w-full"},null,512),p("div",wt,[p("div",{class:le(["sticky top-16 z-10 flex flex-row gap-4 rounded-lg border bg-background-elevated/90 px-4 py-3 backdrop-blur transition-all duration-300",{"-mx-4 rounded-none border-x-0 border-t-0 !bg-background/90 @3xl/main:rounded-b-lg @3xl/main:border-x @3xl/main:!bg-background-elevated/90":u.value}])},[p("div",xt,[a(e(xa),{class:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2"}),a(te,{type:"text",modelValue:c.value,"onUpdate:modelValue":k[0]||(k[0]=I=>c.value=I),autocomplete:"off",placeholder:"Buscar",class:"w-full py-2 pl-11 pr-4 text-sm"},null,8,["modelValue"])]),a(e(Ce),{open:d.value,"onUpdate:open":k[3]||(k[3]=I=>d.value=I)},{default:t(()=>[a(e(Te),{asChild:""},{default:t(()=>[a(e(H),{class:"gap-2"},{default:t(()=>[a(e(J),{class:"h-5 w-5"}),$t]),_:1})]),_:1}),a(e(Se),{onEscapeKeyDown:k[2]||(k[2]=I=>I.preventDefault()),class:"max-h-[calc(100dvh-2rem)] w-[calc(100vw-2rem)] max-w-2xl grid-rows-[auto_minmax(0,1fr)_auto] gap-0 rounded-lg p-0 transition-[opacity,_transform]"},{default:t(()=>[a(e(Pe),{class:"border-b p-6 pb-4"},{default:t(()=>[a(e(Be),null,{default:t(()=>[p("div",kt,[a(e($a),{class:"h-8 w-8"}),Ct])]),_:1}),a(e(Ie),null,{default:t(()=>[b(" Crea una nueva rifa ")]),_:1})]),_:1}),p("div",St,[a(bt,{withoutActions:"",id:"raffle-form",isSubmiting:n.value,"onUpdate:isSubmiting":k[1]||(k[1]=I=>n.value=I),onSuccess:A},null,8,["isSubmiting"])]),a(e(ka),{class:"gap-2 border-t p-6 pt-4"},{default:t(()=>[a(e(Ca),{"as-child":""},{default:t(()=>[a(e(H),{variant:"secondary",type:"button",disabled:n.value},{default:t(()=>[b("Cancelar")]),_:1},8,["disabled"])]),_:1}),C((l(),_(e(H),{class:"gap-3",form:"raffle-form",type:"submit",disabled:n.value},{default:t(()=>[n.value?(l(),_(e(ce),{key:0,class:"h-6 w-6"})):(l(),_(e(J),{key:1,class:"h-6 w-6"})),Pt]),_:1},8,["disabled"])),[[X]])]),_:1})]),_:1})]),_:1},8,["open"])],2),p("div",Bt,[a(Ae,{raffles:W.value,loading:s.value},null,8,["raffles","loading"])])]),Ft])}}});export{Jt as default};
