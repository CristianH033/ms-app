import{c as A,b as T}from"./sellers-BUZIpvhN.js";import{_ as P}from"./SellersList.vue_vue_type_script_setup_true_lang-C59_vzYn.js";import{S as D,_ as U,a as H,b as R,c as Z,d as G}from"./AlertDialogDescription.vue_vue_type_script_setup_true_lang-Ctl7R1fG.js";import{c as K,_ as W}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-il5MzxJO.js";import{d as L,q as Y,o as n,j as X,e,y as J,n as O,p as Q,r as b,z as ee,a1 as I,a2 as ae,c as f,a as y,b as a,w as l,D as g,B as F,v,t as le,ab as se,_ as C,a6 as oe,a7 as te}from"./index-_SyS5VNF.js";import{t as ne,z as h,a as ie,_ as x,b as $,c as w,d as S,F as E}from"./vee-validate-zod.esm-CCVB3W0g.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-BD_WEcCY.js";import{_ as re}from"./ImageInput.vue_vue_type_script_setup_true_lang-DQt78TDG.js";import{u as ue}from"./storage-SD6hIaVl.js";import"./magnifer-outline-CCi7kegb.js";import"./strings-BzWVocVB.js";import"./thumbHash-Ci89Ad7b.js";const de=L({__name:"PhoneInput",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(V,{emit:p}){const c=V,d=Y(c,"modelValue",p,{passive:!0,defaultValue:c.defaultValue});return(r,t)=>(n(),X(e(K),{unmasked:e(d),"onUpdate:unmasked":t[0]||(t[0]=u=>J(d)?d.value=u:null),type:"text",mask:"000-000-00-00",placeholder:"3XX-XXX-XX-XX",class:O(e(Q)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-right text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c.class)),inputmode:"numeric"},null,8,["unmasked","class"]))}}),ce=["disabled"],me={style:{position:"relative"}},fe={key:0,role:"alert",id:"radix-136-form-item-message",class:"text-sm font-medium text-destructive",type:"error"},_e=y("span",null,"Cancelar",-1),pe=y("span",null,"Crear",-1),ve=1,he=5e6,ge=L({__name:"SellerForm",emits:["submit","cancel","success","error"],setup(V,{emit:p}){const c=["image/jpeg","image/jpg","image/png","image/webp"],i=p,d=b(!1),r=ee(()=>d.value),t=b(null),u=b(null),M=ne(h.object({name:h.string({required_error:"El nombre es requerido"}).transform(s=>s.toLocaleLowerCase()),email:h.string().email({message:"Email invalido"}).optional().or(h.literal("")),phone:h.string({required_error:"El teléfono es requerido"}).refine(s=>s.length===10,{message:"El teléfono debe tener 10 dígitos"}),photo:h.instanceof(File).refine(s=>s instanceof File,{message:"Debe seleccionar una imagen"}).refine(s=>c.includes(s.type),{message:"Tipo de archivo no aceptado"}).refine(s=>s.size>=ve,{message:"El archivo está vacío"}).refine(s=>s.size<=he,{message:"El archivo es demasiado grande"}).optional()})),{handleSubmit:B}=ie({validationSchema:M,initialValues:{}}),j=()=>{i("cancel")},N=B(async s=>{i("submit"),console.log(s),d.value=!0;const _={name:s.name,email:s.email||null,phone:s.phone,avatar_url:null,thumb_hash:null};s.photo&&await ue(s.photo,s.photo.name,"avatars").then(o=>{console.log(o),_.avatar_url=o==null?void 0:o.fullPath,_.thumb_hash=t.value}).catch(o=>{console.error(o)}),A(_).then(o=>{i("success"),console.log(o)}).catch(o=>{i("error"),console.error(o),u.value=o.message}).finally(()=>{d.value=!1})},({errors:s})=>{console.log(s)});return I(async()=>{}),(s,_)=>{const o=ae("auto-animate");return n(),f("form",{onSubmit:_[1]||(_[1]=te((...m)=>e(N)&&e(N)(...m),["prevent"]))},[y("fieldset",{disabled:r.value},[a(e(E),{name:"name"},{default:l(({componentField:m})=>[a(e(x),null,{default:l(()=>[a(e($),null,{default:l(()=>[g("Nombre")]),_:1}),a(e(w),null,{default:l(()=>[a(e(q),F({type:"text",placeholder:"Nombre del vendedor"},m,{required:""}),null,16)]),_:2},1024),v((n(),f("div",null,[a(e(S))])),[[o]])]),_:2},1024)]),_:1}),a(e(E),{name:"email"},{default:l(({componentField:m})=>[a(e(x),null,{default:l(()=>[a(e($),null,{default:l(()=>[g("E-mail")]),_:1}),a(e(w),null,{default:l(()=>[a(e(q),F({type:"email",placeholder:"mail@example.com"},m),null,16)]),_:2},1024),v((n(),f("div",null,[a(e(S))])),[[o]])]),_:2},1024)]),_:1}),a(e(E),{name:"phone"},{default:l(({value:m,handleChange:k})=>[a(e(x),null,{default:l(()=>[a(e($),null,{default:l(()=>[g("Numero de contacto")]),_:1}),a(e(w),null,{default:l(()=>[a(de,{"model-value":m,"onUpdate:modelValue":z=>k(z,!0),required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),v((n(),f("div",null,[a(e(S))])),[[o]])]),_:2},1024)]),_:1}),a(e(E),{name:"photo"},{default:l(({componentField:m})=>[a(e(x),null,{default:l(()=>[a(e($),null,{default:l(()=>[g("Foto de perfil")]),_:1}),a(e(w),null,{default:l(()=>[a(re,F(m,{base64ThumbHash:t.value,"onUpdate:base64ThumbHash":_[0]||(_[0]=k=>t.value=k)}),null,16,["base64ThumbHash"])]),_:2},1024),v((n(),f("div",null,[a(e(S))])),[[o]])]),_:2},1024)]),_:1}),v((n(),f("div",me,[u.value!==null?(n(),f("p",fe,le(u.value),1)):se("",!0)])),[[o]]),a(e(x),{class:"flex w-full flex-col-reverse items-center justify-end gap-2 space-y-0 py-2 md:flex-row"},{default:l(()=>[a(e(C),{type:"button",class:"w-full gap-2",variant:"outline",onClick:j},{default:l(()=>[_e]),_:1}),a(e(C),{type:"submit",class:"w-full gap-2"},{default:l(()=>[v((n(),f("div",null,[d.value?(n(),X(e(oe),{key:0,class:"h-6 w-6"})):(n(),X(e(D),{key:1,class:"h-6 w-6"}))])),[[o]]),pe]),_:1})]),_:1})],8,ce)],32)}}}),be={class:"flex w-full flex-col items-center"},ye=y("span",{class:"hidden md:inline"},"Nuevo vendedor",-1),xe={class:"grid gap-4 py-4"},$e=y("span",null,"Crear vendedor",-1),qe=L({__name:"SellersView",setup(V){const p=b(!1),c=b([]),i=b(!1),d=()=>{i.value=!1,T().then(r=>{c.value=r}).catch(r=>{console.log(r)})};return I(async()=>{p.value=!0,T().then(r=>{c.value=r}).catch(r=>{console.log(r)}).finally(()=>{p.value=!1})}),(r,t)=>(n(),f("div",be,[a(P,{sellers:c.value,isLoading:p.value},{actionButton:l(()=>[a(e(U),{open:i.value,"onUpdate:open":t[2]||(t[2]=u=>i.value=u)},{default:l(()=>[a(e(W),{"as-child":""},{default:l(()=>[a(e(C),{class:"gap-2"},{default:l(()=>[a(e(D),{class:"h-5 w-5"}),ye]),_:1})]),_:1}),a(e(H),{onEscapeKeyDown:t[1]||(t[1]=u=>u.preventDefault())},{default:l(()=>[a(e(R),null,{default:l(()=>[a(e(Z),null,{default:l(()=>[g("Crear nuevo vendedor")]),_:1}),a(e(G),null,{default:l(()=>[g(" Crea un nuevo vendedor ")]),_:1})]),_:1}),y("div",xe,[a(ge,{onSuccess:d,onCancel:t[0]||(t[0]=u=>i.value=!1)})])]),_:1})]),_:1},8,["open"])]),actionForEmpty:l(()=>[a(e(C),{class:"gap-2",onClick:t[3]||(t[3]=u=>i.value=!0)},{default:l(()=>[a(e(D),{class:"h-5 w-5"}),$e]),_:1})]),_:1},8,["sellers","isLoading"])]))}});export{qe as default};
