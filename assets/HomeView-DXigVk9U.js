import{_ as Te}from"./RafflesList.vue_vue_type_script_setup_true_lang-DuQrNHYu.js";import{S as Y,_ as Se,a as Pe,b as Be,c as Fe,d as Ie}from"./AlertDialogDescription.vue_vue_type_script_setup_true_lang-Dw9Tkq-r.js";import{c as ne,a as Oe,g as He}from"./createLucideIcon-DhyDiip-.js";import{d as x,o as l,c as _,l as B,e,n as le,p as D,s as re,m as je,a as m,q as Ge,v as k,x as We,y as Ze,z as P,A as ue,j as p,w as t,b as a,i as K,F as X,B as w,C as Ke,D as y,t as J,E as j,M as Xe,G as ie,H as Ye,I as Je,J as Q,K as se,L as Qe,N as ea,O as aa,V as ta,P as sa,Q as la,S as oa,U as na,W as ra,X as ua,Y as ia,Z as da,r as U,$ as ca,a0 as _e,a1 as de,a2 as ce,_ as H,a3 as he,a4 as fa,a5 as ma,a6 as fe,a7 as Ve,a8 as pa,a9 as ge,aa as _a,ab as ha,ac as ga,ad as oe,ae as va}from"./index-D_lficq2.js";import{u as ba,t as ze,z as S,a as De,_ as z,b as N,c as L,d as M,F as R}from"./FormMessage.vue_vue_type_script_setup_true_lang-BwLr68lD.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-B0nCAqlZ.js";import{_ as qe,a as Ee,b as Ne,c as Le,d as Me,e as Re,f as Ue,g as ve}from"./MoneyInput.vue_vue_type_script_setup_true_lang-sa4Ja0qr.js";import{_ as be}from"./ImageInput.vue_vue_type_script_setup_true_lang-Chi1r2-H.js";import{S as ya}from"./cup-star-line-duotone-CJPy5g0y.js";import{_ as Ae}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-BYSeLqOa.js";import{v as ye,u as wa}from"./storage-MYsPSVgF.js";import{S as xa}from"./magnifer-outline-C-PTv6hz.js";import{S as $a}from"./ticket-line-duotone-C6hAeG8x.js";import{_ as ka,a as Ca}from"./AlertDialogCancel.vue_vue_type_script_setup_true_lang-VQWLXqut.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-CvqWZmhz.js";import"./CardContent.vue_vue_type_script_setup_true_lang-nVZEnwlY.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-CuTMza98.js";import"./user-speak-line-duotone-C1aHHBO-.js";import"./LazyImg-C2Ey-7qJ.js";import"./thumbHash-Ci89Ad7b.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Sa=["id"],we=x({__name:"FormDescription",props:{class:{}},setup(u){const s=u,{formDescriptionId:n}=ba();return(c,o)=>(l(),_("p",{id:e(n),class:le(e(D)("text-sm text-muted-foreground",s.class))},[B(c.$slots,"default")],10,Sa))}}),xe=async()=>{const{data:u,error:s}=await re.from("draws").select("*");if(s)throw new Error(s.message);return u},Pa=async u=>{const{error:s}=await re.from("draws").insert(u);if(s)throw new Error(s.message);return!0};const Ba=ne("CalendarIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const Fa=ne("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Va=ne("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),za={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Da=m("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[m("path",{d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.535 1.464C22 4.93 22 7.286 22 12s0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z",opacity:".5"}),m("path",{"stroke-linecap":"round",d:"m14.5 9.5l-5 5m0-5l5 5"})],-1),qa=[Da];function Ea(u,s){return l(),_("svg",za,[...qa])}const Na=je({name:"solar-close-square-line-duotone",render:Ea}),La=x({__name:"Textarea",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(u,{emit:s}){const n=u,o=Ge(n,"modelValue",s,{passive:!0,defaultValue:n.defaultValue});return(i,d)=>k((l(),_("textarea",{"onUpdate:modelValue":d[0]||(d[0]=C=>Ze(o)?o.value=C:null),class:le(e(D)("flex min-h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n.class))},null,2)),[[We,e(o)]])}}),Ma={class:"flex flex-col gap-y-4 mt-4 sm:flex-row sm:gap-x-4 sm:gap-y-0"},Ra=x({__name:"Calendar",props:{modelValue:{},multiple:{type:Boolean},defaultValue:{},defaultPlaceholder:{},placeholder:{},pagedNavigation:{type:Boolean},preventDeselect:{type:Boolean},weekStartsOn:{},weekdayFormat:{},calendarLabel:{},fixedWeeks:{type:Boolean},maxValue:{},minValue:{},locale:{},numberOfMonths:{},disabled:{type:Boolean},readonly:{type:Boolean},initialFocus:{type:Boolean},isDateDisabled:{type:Function},isDateUnavailable:{type:Function},dir:{},nextPage:{type:Function},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:placeholder"],setup(u,{emit:s}){const n=u,c=s,o=P(()=>{const{class:d,...C}=n;return C}),i=ue(o,c);return(d,C)=>(l(),p(e(Ke),w({class:e(D)("p-3",n.class)},e(i)),{default:t(({grid:G,weekDays:W})=>[a(e(ja),null,{default:t(()=>[a(e(Za)),a(e(Ga)),a(e(Wa))]),_:1}),m("div",Ma,[(l(!0),_(X,null,K(G,E=>(l(),p(e(Ta),{key:E.value.toString()},{default:t(()=>[a(e(Oa),null,{default:t(()=>[a(e($e),null,{default:t(()=>[(l(!0),_(X,null,K(W,F=>(l(),p(e(Ha),{key:F},{default:t(()=>[y(J(F),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a(e(Ia),null,{default:t(()=>[(l(!0),_(X,null,K(E.rows,(F,$)=>(l(),p(e($e),{key:`weekDate-${$}`,class:"mt-2 w-full"},{default:t(()=>[(l(!0),_(X,null,K(F,V=>(l(),p(e(Ua),{key:V.toString(),date:V},{default:t(()=>[a(e(Aa),{day:V,month:E.value},null,8,["day","month"])]),_:2},1032,["date"]))),128))]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},16,["class"]))}}),Ua=x({__name:"CalendarCell",props:{date:{},asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(Xe),w({class:e(D)("relative h-9 w-9 p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([data-selected])]:rounded-md [&:has([data-selected])]:bg-accent [&:has([data-selected][data-outside-month])]:bg-accent/50",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),Aa=x({__name:"CalendarCellTrigger",props:{day:{},month:{},asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(Ye),w({class:e(D)(e(ie)({variant:"ghost"}),"h-9 w-9 p-0 font-normal","[&[data-today]:not([data-selected])]:bg-accent [&[data-today]:not([data-selected])]:text-accent-foreground","data-[selected]:bg-primary data-[selected]:text-primary-foreground data-[selected]:opacity-100 data-[selected]:hover:bg-primary data-[selected]:hover:text-primary-foreground data-[selected]:focus:bg-primary data-[selected]:focus:text-primary-foreground","data-[disabled]:text-muted-foreground data-[disabled]:opacity-50","data-[unavailable]:text-destructive-foreground data-[unavailable]:line-through","data-[outside-month]:pointer-events-none data-[outside-month]:text-muted-foreground data-[outside-month]:opacity-50 [&[data-outside-month][data-selected]]:bg-accent/50 [&[data-outside-month][data-selected]]:text-muted-foreground [&[data-outside-month][data-selected]]:opacity-30",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),Ta=x({__name:"CalendarGrid",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(Je),w({class:e(D)("w-full border-collapse space-y-1",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),Ia=x({__name:"CalendarGridBody",props:{asChild:{type:Boolean},as:{}},setup(u){const s=u;return(n,c)=>(l(),p(e(Qe),Q(se(s)),{default:t(()=>[B(n.$slots,"default")]),_:3},16))}}),Oa=x({__name:"CalendarGridHead",props:{asChild:{type:Boolean},as:{}},setup(u){const s=u;return(n,c)=>(l(),p(e(ea),Q(se(s)),{default:t(()=>[B(n.$slots,"default")]),_:3},16))}}),$e=x({__name:"CalendarGridRow",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(aa),w({class:e(D)("flex",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),Ha=x({__name:"CalendarHeadCell",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(ta),w({class:e(D)("w-9 rounded-md text-[0.8rem] font-normal text-muted-foreground",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),ja=x({__name:"CalendarHeader",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(sa),w({class:e(D)("relative flex w-full items-center justify-between pt-1",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default")]),_:3},16,["class"]))}}),Ga=x({__name:"CalendarHeading",props:{asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(la),w({class:e(D)("text-sm font-medium",s.class)},e(c)),{default:t(({headingValue:d})=>[B(o.$slots,"default",{headingValue:d},()=>[y(J(d),1)])]),_:3},16,["class"]))}}),Wa=x({__name:"CalendarNextButton",props:{step:{},nextPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(oa),w({class:e(D)(e(ie)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default",{},()=>[a(e(Va),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Za=x({__name:"CalendarPrevButton",props:{step:{},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(u){const s=u,n=P(()=>{const{class:o,...i}=s;return i}),c=j(n);return(o,i)=>(l(),p(e(na),w({class:e(D)(e(ie)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[B(o.$slots,"default",{},()=>[a(e(Fa),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ka=x({__name:"Popover",props:{defaultOpen:{type:Boolean},open:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(u,{emit:s}){const o=ue(u,s);return(i,d)=>(l(),p(e(ra),Q(se(e(o))),{default:t(()=>[B(i.$slots,"default")]),_:3},16))}}),Xa=x({__name:"PopoverTrigger",props:{asChild:{type:Boolean},as:{}},setup(u){const s=u;return(n,c)=>(l(),p(e(ua),Q(se(s)),{default:t(()=>[B(n.$slots,"default")]),_:3},16))}}),Ya=x({inheritAttrs:!1,__name:"PopoverContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},side:{},sideOffset:{default:4},align:{default:"center"},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(u,{emit:s}){const n=u,c=s,o=P(()=>{const{class:d,...C}=n;return C}),i=ue(o,c);return(d,C)=>(l(),p(e(da),null,{default:t(()=>[a(e(ia),w({...e(i),...d.$attrs},{class:e(D)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n.class)}),{default:t(()=>[B(d.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Ja=async()=>{const{data:u,error:s}=await re.from("lotteries").select("*");if(s)throw new Error(s.message);return u},Qa=["aria-disabled"],et=["disabled"],at=m("input",{hidden:""},null,-1),tt=m("span",null,"Cancelar",-1),st=m("span",null,"Crear",-1),lt=x({__name:"DrawForm",emits:["submit","success","error","cancel"],setup(u,{emit:s}){const n=U("idle"),c=U([]),o=s,i=P(()=>n.value==="pending"),d=P(()=>n.value==="pending"||i.value),C=new ca("es-CO",{dateStyle:"long"}),G=ze(S.object({lottery_id:S.string({required_error:"Lotería es requerida"}).refine(g=>{var A;return(A=c.value)==null?void 0:A.some(T=>T.id.toString()===g)},{message:"El Sorteo no existe"}),name:S.string().refine(g=>g,{message:"La descripción es requerida"}),drawn_at:S.string().refine(g=>g,{message:"La fecha es requerida"})})),{handleSubmit:W,setFieldValue:E,values:F}=De({validationSchema:G,initialValues:{}}),$=P({get:()=>F.drawn_at?pa(F.drawn_at):void 0,set:g=>g}),V=()=>{Ja().then(g=>{c.value=g}).catch(g=>{console.error(g)}).finally(()=>{})},Z=W(g=>{n.value="pending",Pa({...g,lottery_id:parseInt(g.lottery_id)}).then(()=>{n.value="success"}).catch(()=>{n.value="error"}).finally(()=>{setTimeout(()=>{n.value="idle"},500)})}),I=()=>{o("cancel")};return _e($,g=>{g&&(!F.name||F.name.startsWith("Sorteo del "))&&E("name",`Sorteo del ${C.format(he(g))}`)}),_e(n,g=>{g==="success"&&o("success"),g==="error"&&o("error"),g==="pending"&&o("submit",F)}),de(async()=>{V()}),(g,A)=>{const T=ce("auto-animate");return l(),_("form",{onSubmit:A[2]||(A[2]=Ve((...q)=>e(Z)&&e(Z)(...q),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":d.value},[m("fieldset",{disabled:d.value},[a(e(R),{name:"lottery_id"},{default:t(({componentField:q})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Lotería")]),_:1}),a(e(qe),Q(se(q)),{default:t(()=>[a(e(L),null,{default:t(()=>[a(e(Ee),null,{default:t(()=>[a(e(Ne),{placeholder:"Elige una loteria"})]),_:1})]),_:1}),a(e(Le),null,{default:t(()=>[a(e(Me),null,{default:t(()=>[a(e(Re),null,{default:t(()=>[y("Loterías")]),_:1}),(l(!0),_(X,null,K(c.value,ee=>(l(),p(e(Ue),{key:ee.id,value:ee.id.toString()},{default:t(()=>[y(J(ee.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040),k((l(),_("div",null,[a(e(M))])),[[T]])]),_:2},1024)]),_:1}),a(e(R),{name:"name"},{default:t(({componentField:q})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Descripción del sorteo")]),_:1}),a(e(L),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Descripción corta del sorteo"},q,{required:""}),null,16)]),_:2},1024),a(e(we),null,{default:t(()=>[y(' Descripción corta del sorteo, e.j. "Sorteo del 10 de Mayo de 2024". ')]),_:1}),k((l(),_("div",null,[a(e(M))])),[[T]])]),_:2},1024)]),_:1}),a(e(R),{name:"drawn_at"},{default:t(()=>[a(e(z),{class:"flex flex-col"},{default:t(()=>[a(e(N),null,{default:t(()=>[y("Fecha del sorteo")]),_:1}),a(e(Ka),null,{default:t(()=>[a(e(Xa),{"as-child":""},{default:t(()=>[a(e(L),null,{default:t(()=>[a(e(H),{variant:"outline",class:le(e(D)("w-full ps-3 text-start font-normal",!$.value&&"text-muted-foreground"))},{default:t(()=>[m("span",null,J($.value?e(C).format(e(he)($.value)):"Seleccione una fecha"),1),a(e(Ba),{class:"ms-auto h-4 w-4 opacity-50"})]),_:1},8,["class"]),at]),_:1})]),_:1}),a(e(Ya),{class:"w-auto p-0"},{default:t(()=>[a(e(Ra),{modelValue:$.value,"onUpdate:modelValue":[A[0]||(A[0]=q=>$.value=q),A[1]||(A[1]=q=>{q?e(E)("drawn_at",q.toString()):e(E)("drawn_at",void 0)})],"calendar-label":"Date of birth","initial-focus":"","min-value":e(fa)(e(ma)())},null,8,["modelValue","min-value"])]),_:1})]),_:1}),a(e(we),null,{default:t(()=>[y(" Fecha del sorteo. ")]),_:1}),k((l(),_("div",null,[a(e(M))])),[[T]])]),_:1})]),_:1}),a(e(z),{class:"flex w-full flex-col-reverse items-center justify-end gap-2 space-y-0 py-2 md:flex-row"},{default:t(()=>[a(e(H),{type:"button",class:"w-full gap-2 @xl/form:w-auto",variant:"outline",onClick:I},{default:t(()=>[tt]),_:1}),k((l(),p(e(H),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[i.value?(l(),p(e(fe),{key:0,class:"h-6 w-6"})):(l(),p(e(Y),{key:1,class:"h-6 w-6"})),st]),_:1})),[[T]])]),_:1})],8,et)],40,Qa)}}}),ot=["aria-disabled"],nt=["disabled"],rt={class:"flex flex-row gap-2"},ut={key:0,class:"p-4",value:""},it={class:"grid gap-4 sm:grid-cols-2 sm:gap-6"},dt={class:"col-span-2 flex flex-col gap-4 rounded-md border p-4"},ct={class:"flex gap-2 text-lg font-medium"},ft=m("span",null,"Premios",-1),mt=["onClick"],pt={class:"w-full rounded-md border p-4"},_t={class:"text-lg font-medium"},ht={class:"flex w-full flex-row items-center justify-end py-2"},gt=m("span",null,"Agregar premio",-1),vt=m("span",null,"Crear",-1),ke=1,Ce=5e6,bt=x({__name:"RaffleForm",props:ge({withoutActions:{type:[Boolean,String],default:!1}},{isSubmiting:{type:Boolean,required:!1,default:!1},isSubmitingModifiers:{}}),emits:ge(["success"],["update:isSubmiting"]),setup(u,{emit:s}){const n=["image/jpeg","image/jpg","image/png","image/webp"],c=u,o=_a(u,"isSubmiting"),i=U([]),d=U({draw_id:void 0,name:"",description:"",image_path:null,thumb_hash:null,number_of_tickets:1e3,ticket_price:"",prizes:[{key:ye().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null}]}),C=ha(async()=>await xe()),G=ga(()=>{console.log("Clearing cache"),C.clear()},3e4),W=ze(S.object({draw_id:S.string({required_error:"Sorteo es requerido"}).refine(async r=>{try{G()}catch(f){console.error(f)}return await C().then(f=>f==null?void 0:f.some(h=>h.id.toString()===r))},{message:"El Sorteo no existe"}),name:S.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),description:S.string({required_error:"La descripción es requerida"}).min(3,{message:"La descripción debe tener al menos 3 caracteres"}),number_of_tickets:S.number({required_error:"El numero de tickets es requerido"}).min(100,{message:"El numero de tickets debe ser mayor o igual a 100"}),ticket_price:S.string({required_error:"El valor es requerido"}).transform(r=>parseFloat(r)).refine(r=>!isNaN(r)&&r>=1,{message:"El valor debe ser un número mayor o igual a 1"}),prizes:S.array(S.object({name:S.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),prize_value:S.string({required_error:"El valor es requerido"}).transform(r=>parseFloat(r)).refine(r=>!isNaN(r)&&r>=1,{message:"El valor debe ser un número mayor o igual a 1"}),image:S.instanceof(File).refine(r=>r instanceof File,{message:"Debe seleccionar una imagen"}).refine(r=>n.includes(r.type),{message:"Tipo de archivo no aceptado"}).refine(r=>r.size>=ke,{message:"El archivo está vacío"}).refine(r=>r.size<=Ce,{message:"El archivo es demasiado grande"})})).min(1),image:S.instanceof(File).refine(r=>r instanceof File,{message:"Debe seleccionar una imagen"}).refine(r=>n.includes(r.type),{message:"Tipo de archivo no aceptado"}).refine(r=>r.size>=ke,{message:"El archivo está vació"}).refine(r=>r.size<=Ce,{message:"El archivo es demasiado grande"})})),E=De({validationSchema:W,initialValues:{number_of_tickets:d.value.number_of_tickets}}),F=s,$=()=>{d.value.prizes.push({key:ye().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null})},V=r=>{d.value.prizes.length>1&&d.value.prizes.find(h=>h.key===r)&&(d.value.prizes=d.value.prizes.filter(h=>h.key!==r))},Z=async r=>{const f=await wa(r,r.name,"covers");return f==null?void 0:f.fullPath},I=async r=>{const f=await{draw_id:parseInt(r.draw_id),name:r.name,description:r.description,image_path:await Z(r.image),thumb_hash:d.value.thumb_hash,number_of_tickets:r.number_of_tickets,ticket_price:r.ticket_price,prizes:[]};return await r.prizes.forEach(async(h,b)=>{await Z(h.image).then(v=>{f.prizes.push({name:h.name,prize_value:h.prize_value,thumb_hash:d.value.prizes[b].thumb_hash,image_path:v})})}),f},g=E.handleSubmit(async r=>{o.value=!0,E.setErrors({}),o.value=!1;const f=await I(r);Oe(f).then(h=>{console.log(h),F("success")}).catch(h=>{console.log(h)}).finally(()=>{o.value=!1})},({errors:r})=>{const f=Object.keys(r)[0].replace("[",".").replace("]",""),h=document.querySelector(`[name="${f}"]`);h&&h.scrollIntoView({behavior:"smooth",block:"center"})}),A=P(()=>c.withoutActions===""||c.withoutActions===!0),T=U(!1),q=()=>{T.value=!1},ee=async()=>{q(),await me()},me=async()=>{o.value=!0,await xe().then(r=>i.value=r).finally(()=>o.value=!1),console.log(i.value)};return de(async()=>{await me()}),(r,f)=>{const h=ce("auto-animate");return l(),_("form",{onSubmit:f[6]||(f[6]=Ve((...b)=>e(g)&&e(g)(...b),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":o.value},[m("fieldset",{disabled:o.value},[a(e(R),{name:"name"},{default:t(({componentField:b})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Nombre")]),_:1}),a(e(L),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre de la Rifa"},b,{"model-value":d.value.name,"onUpdate:modelValue":f[0]||(f[0]=v=>d.value.name=v),required:""}),null,16,["model-value"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(R),{name:"draw_id"},{default:t(({componentField:b})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Sorteo")]),_:1}),a(e(qe),w(b,{"model-value":d.value.draw_id,"onUpdate:modelValue":f[2]||(f[2]=v=>d.value.draw_id=v)}),{default:t(()=>[a(e(L),null,{default:t(()=>[m("div",rt,[a(e(Ee),null,{default:t(()=>[a(e(Ne),{placeholder:"Elige un sorteo"})]),_:1}),a(e(Se),{open:T.value,"onUpdate:open":f[1]||(f[1]=v=>T.value=v)},{default:t(()=>[a(e(Ae),{"as-child":""},{default:t(()=>[a(e(H),{variant:"outline",type:"button"},{default:t(()=>[a(e(Y),{class:"h-6 w-6"})]),_:1})]),_:1}),a(e(Pe),null,{default:t(()=>[a(e(Be),null,{default:t(()=>[a(e(Fe),null,{default:t(()=>[y("Crear nuevo sorteo")]),_:1}),a(lt,{onSuccess:ee,onCancel:q})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1}),a(e(Le),null,{default:t(()=>[a(e(Me),null,{default:t(()=>[a(e(Re),null,{default:t(()=>[y("Sorteos")]),_:1}),i.value.length===0?(l(),_("div",ut,"No hay sorteos")):oe("",!0),(l(!0),_(X,null,K(i.value,v=>(l(),p(e(Ue),{key:v.id,value:v.id.toString()},{default:t(()=>[y(J(v.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040,["model-value"]),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(R),{name:"description"},{default:t(({componentField:b})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Descripción")]),_:1}),a(e(L),null,{default:t(()=>[a(e(La),w({type:"text",placeholder:"Descripción de la Rifa"},b,{"model-value":d.value.description,"onUpdate:modelValue":f[3]||(f[3]=v=>d.value.description=v),required:""}),null,16,["model-value"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(R),{name:"number_of_tickets"},{default:t(({componentField:b})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Número de Bonos:")]),_:1}),a(e(L),null,{default:t(()=>[a(e(te),w({type:"number",inputmode:"numeric",placeholder:"Nombre de la Rifa"},b,{"model-value":d.value.number_of_tickets,"onUpdate:modelValue":f[4]||(f[4]=v=>d.value.number_of_tickets=v),required:""}),null,16,["model-value"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(R),{name:"ticket_price"},{default:t(({value:b,handleChange:v})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Costo del Bono")]),_:1}),a(e(L),null,{default:t(()=>[a(ve,{"model-value":b,"onUpdate:modelValue":O=>{v(O,!0),d.value.ticket_price=O.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),a(e(R),{name:"image"},{default:t(({componentField:b})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Portada de la rifa")]),_:1}),a(e(L),null,{default:t(()=>[a(be,w(b,{base64ThumbHash:d.value.thumb_hash,"onUpdate:base64ThumbHash":f[5]||(f[5]=v=>d.value.thumb_hash=v)}),null,16,["base64ThumbHash"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:1}),m("div",it,[k((l(),_("fieldset",dt,[m("legend",ct,[a(e(ya),{class:"h-8 w-8"}),ft]),(l(!0),_(X,null,K(d.value.prizes,(b,v)=>(l(),_("div",{class:"relative w-full",key:b.key},[d.value.prizes.length>1?(l(),_("button",{key:0,type:"button",class:"absolute right-0 top-0 rounded-xl bg-background",onClick:O=>V(b.key)},[a(e(Na),{class:"h-8 w-8"})],8,mt)):oe("",!0),m("fieldset",pt,[m("legend",_t,"Premio "+J(v+1),1),a(e(R),{name:"prizes."+v+".name"},{default:t(({componentField:O})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Nombre")]),_:1}),a(e(L),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre del premio",ref_for:!0},O,{"model-value":b.name,"onUpdate:modelValue":ae=>b.name=ae,required:""}),null,16,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(R),{name:"prizes."+v+".prize_value"},{default:t(({value:O,handleChange:ae})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Valor del premio")]),_:1}),a(e(L),null,{default:t(()=>[a(ve,{"model-value":O,"onUpdate:modelValue":pe=>{ae(pe,!0),b.prize_value=pe.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(R),{name:"prizes."+v+".image"},{default:t(({componentField:O})=>[a(e(z),null,{default:t(()=>[a(e(N),null,{default:t(()=>[y("Imagen")]),_:1}),a(e(L),null,{default:t(()=>[a(be,w({ref_for:!0},O,{base64ThumbHash:b.thumb_hash,"onUpdate:base64ThumbHash":ae=>b.thumb_hash=ae}),null,16,["base64ThumbHash","onUpdate:base64ThumbHash"])]),_:2},1024),k((l(),_("div",null,[a(e(M))])),[[h]])]),_:2},1024)]),_:2},1032,["name"])])]))),128)),m("div",ht,[a(e(H),{variant:"outline",type:"button",class:"w-full gap-2 @xl/form:w-auto",onClick:$},{default:t(()=>[a(e(Y),{class:"h-6 w-6"}),gt]),_:1})])])),[[h]])]),A.value?oe("",!0):B(r.$slots,"actions",Q(w({key:0},{isSubmiting:o.value})),()=>[a(e(z),{class:"flex w-full flex-row items-center justify-end py-2"},{default:t(()=>[k((l(),p(e(H),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[o.value?(l(),p(e(fe),{key:0,class:"h-6 w-6"})):(l(),p(e(Y),{key:1,class:"h-6 w-6"})),vt]),_:1})),[[h]])]),_:1})])],8,nt)],40,ot)}}}),yt={class:"flex w-full flex-col items-center"},wt={class:"flex w-full max-w-3xl flex-col gap-4"},xt={class:"relative grow"},$t=m("span",{class:"hidden md:inline"},"Nueva rifa",-1),kt={class:"flex flex-row items-center justify-start gap-2"},Ct=m("span",null," Nueva Rifa ",-1),St={class:"relative overflow-y-auto px-6 py-4"},Pt=m("span",null,"Crear",-1),Bt={class:"flex w-full flex-col items-center gap-4"},Ft=m("div",{class:"flex w-full flex-col items-center"},null,-1),Yt=x({__name:"HomeView",setup(u){const s=U(!1),n=U(!1),c=U(""),o=U([]),i=U(!1),d=U(!1),C=U(null),G=P(()=>o.value.filter($=>$.name.toLowerCase().includes(c.value.toLowerCase())));va(C,([{isIntersecting:$}])=>{d.value=!$},{rootMargin:"-65px",threshold:1});const W=()=>{i.value=!1},E=async()=>{W(),await F()},F=async()=>{s.value=!0,await He().then($=>{o.value=$}).catch($=>{console.log($)}).finally(()=>{s.value=!1})};return de(async()=>{await F()}),($,V)=>{const Z=ce("auto-animate");return l(),_("div",yt,[m("div",{ref_key:"sentinal",ref:C,class:"h-0 w-full"},null,512),m("div",wt,[m("div",{class:le(["sticky top-16 z-10 flex flex-row gap-4 rounded-lg border bg-background-elevated/90 px-4 py-3 backdrop-blur transition-all duration-300",{"-mx-4 rounded-none border-x-0 border-t-0 !bg-background/90 @3xl/main:rounded-b-lg @3xl/main:border-x @3xl/main:!bg-background-elevated/90":d.value}])},[m("div",xt,[a(e(xa),{class:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2"}),a(te,{type:"text",modelValue:c.value,"onUpdate:modelValue":V[0]||(V[0]=I=>c.value=I),autocomplete:"off",placeholder:"Buscar",class:"w-full py-2 pl-11 pr-4 text-sm"},null,8,["modelValue"])]),a(e(Se),{open:i.value,"onUpdate:open":V[2]||(V[2]=I=>i.value=I)},{default:t(()=>[a(e(Ae),{asChild:""},{default:t(()=>[a(e(H),{class:"gap-2"},{default:t(()=>[a(e(Y),{class:"h-5 w-5"}),$t]),_:1})]),_:1}),a(e(Pe),{class:"max-h-[calc(100dvh-2rem)] w-[calc(100vw-2rem)] max-w-2xl grid-rows-[auto_minmax(0,1fr)_auto] gap-0 rounded-lg p-0 transition-[opacity,_transform]"},{default:t(()=>[a(e(Be),{class:"border-b p-6 pb-4"},{default:t(()=>[a(e(Fe),null,{default:t(()=>[m("div",kt,[a(e($a),{class:"h-8 w-8"}),Ct])]),_:1}),a(e(Ie),null,{default:t(()=>[y(" Crea una nueva rifa ")]),_:1})]),_:1}),m("div",St,[a(bt,{withoutActions:"",id:"raffle-form",isSubmiting:n.value,"onUpdate:isSubmiting":V[1]||(V[1]=I=>n.value=I),onSuccess:E},null,8,["isSubmiting"])]),a(e(ka),{class:"gap-2 border-t p-6 pt-4"},{default:t(()=>[a(e(Ca),{"as-child":""},{default:t(()=>[a(e(H),{variant:"secondary",type:"button",disabled:n.value},{default:t(()=>[y("Cancelar")]),_:1},8,["disabled"])]),_:1}),k((l(),p(e(H),{class:"gap-3",form:"raffle-form",type:"submit",disabled:n.value},{default:t(()=>[n.value?(l(),p(e(fe),{key:0,class:"h-6 w-6"})):(l(),p(e(Y),{key:1,class:"h-6 w-6"})),Pt]),_:1},8,["disabled"])),[[Z]])]),_:1})]),_:1})]),_:1},8,["open"])],2),m("div",Bt,[a(Te,{raffles:G.value,loading:s.value},null,8,["raffles","loading"])])]),Ft])}}});export{Yt as default};
