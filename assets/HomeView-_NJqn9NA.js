import{_ as Oe}from"./RafflesList.vue_vue_type_script_setup_true_lang-Cqh0q46G.js";import{S as Y,_ as Pe,a as Be,b as Fe,c as ze,d as He}from"./AlertDialogDescription.vue_vue_type_script_setup_true_lang-C8SxuWpA.js";import{c as je,g as Ge}from"./raffles-TeWMcrh1.js";import{d as x,o as l,c as v,l as F,e,n as le,p as E,s as re,m as We,a as p,q as Ke,v as k,x as Ze,y as Xe,z as B,A as ie,j as _,w as t,b as a,i as K,F as Z,B as w,C as Ye,D as b,t as J,E as H,M as Je,G as ue,H as Qe,I as ea,J as Q,K as se,L as aa,N as ta,O as sa,V as la,P as oa,Q as na,S as ra,U as ia,W as ua,X as da,Y as ca,Z as fa,r as T,$ as ma,a0 as pa,a1 as de,a2 as ce,_ as O,a3 as ve,a4 as _a,a5 as ha,a6 as fe,a7 as Ve,a8 as va,a9 as ge,aa as ga,ab as ba,ac as ya,ad as ne,ae as wa}from"./index-BpvGhyvb.js";import{u as xa,t as De,z as P,a as Ee,_ as D,b as R,c as M,d as U,F as A}from"./vee-validate-zod.esm-DFwib2_T.js";import{_ as te}from"./Input.vue_vue_type_script_setup_true_lang-C0s0ReV1.js";import{v as be,u as $a}from"./storage-UDqcoODj.js";import{S as ka}from"./cup-star-line-duotone-Dq_FUAqb.js";import{_ as ye}from"./ImageInput.vue_vue_type_script_setup_true_lang-B7edS4vc.js";import{_ as Ne,a as qe,b as Le,c as Re,d as Me,e as Ue,f as Ae,g as we}from"./SelectScrollDownButton.vue_vue_type_script_setup_true_lang-D7Btgpdz.js";import{_ as Te}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-DGyif2gk.js";import{c as me}from"./createLucideIcon-BNiaXTsk.js";import{S as Ca}from"./magnifer-outline-CJqttPRn.js";import{S as Sa}from"./ticket-line-duotone-DAykPjqY.js";import{_ as Pa,a as Ba}from"./AlertDialogCancel.vue_vue_type_script_setup_true_lang-CcqLjjHl.js";import"./user-speak-line-duotone-rNO2FHCo.js";import"./LazyImg-CC4Cl5dX.js";import"./thumbHash-Ci89Ad7b.js";import"./Skeleton.vue_vue_type_script_setup_true_lang-Bz-mh4Ay.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./CardContent.vue_vue_type_script_setup_true_lang-DCrHivXZ.js";import"./CardFooter.vue_vue_type_script_setup_true_lang-BvFGsbgH.js";const Fa=me("CalendarIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const za=me("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Va=me("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Da=["id"],xe=x({__name:"FormDescription",props:{class:{}},setup(i){const s=i,{formDescriptionId:o}=xa();return(c,r)=>(l(),v("p",{id:e(o),class:le(e(E)("text-sm text-muted-foreground",s.class))},[F(c.$slots,"default")],10,Da))}}),$e=async()=>{const{data:i,error:s}=await re.from("draws").select("*");if(s)throw new Error(s.message);return i},Ea=async i=>{const{data:s,error:o}=await re.from("draws").insert(i).select().single();if(o)throw new Error(o.message);return s},Na={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},qa=p("g",{fill:"none",stroke:"currentColor","stroke-width":"1.5"},[p("path",{d:"M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2s7.071 0 8.535 1.464C22 4.93 22 7.286 22 12s0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z",opacity:".5"}),p("path",{"stroke-linecap":"round",d:"m14.5 9.5l-5 5m0-5l5 5"})],-1),La=[qa];function Ra(i,s){return l(),v("svg",Na,[...La])}const Ma=We({name:"solar-close-square-line-duotone",render:Ra}),Ua=x({__name:"Textarea",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(i,{emit:s}){const o=i,r=Ke(o,"modelValue",s,{passive:!0,defaultValue:o.defaultValue});return(u,d)=>k((l(),v("textarea",{"onUpdate:modelValue":d[0]||(d[0]=C=>Xe(r)?r.value=C:null),class:le(e(E)("flex min-h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",o.class))},null,2)),[[Ze,e(r)]])}}),Aa={class:"flex flex-col gap-y-4 mt-4 sm:flex-row sm:gap-x-4 sm:gap-y-0"},Ta=x({__name:"Calendar",props:{modelValue:{},multiple:{type:Boolean},defaultValue:{},defaultPlaceholder:{},placeholder:{},pagedNavigation:{type:Boolean},preventDeselect:{type:Boolean},weekStartsOn:{},weekdayFormat:{},calendarLabel:{},fixedWeeks:{type:Boolean},maxValue:{},minValue:{},locale:{},numberOfMonths:{},disabled:{type:Boolean},readonly:{type:Boolean},initialFocus:{type:Boolean},isDateDisabled:{type:Function},isDateUnavailable:{type:Function},dir:{},nextPage:{type:Function},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue","update:placeholder"],setup(i,{emit:s}){const o=i,c=s,r=B(()=>{const{class:d,...C}=o;return C}),u=ie(r,c);return(d,C)=>(l(),_(e(Ye),w({class:e(E)("p-3",o.class)},e(u)),{default:t(({grid:G,weekDays:W})=>[a(e(Ka),null,{default:t(()=>[a(e(Ya)),a(e(Za)),a(e(Xa))]),_:1}),p("div",Aa,[(l(!0),v(Z,null,K(G,I=>(l(),_(e(Ha),{key:I.value.toString()},{default:t(()=>[a(e(Ga),null,{default:t(()=>[a(e(ke),null,{default:t(()=>[(l(!0),v(Z,null,K(W,z=>(l(),_(e(Wa),{key:z},{default:t(()=>[b(J(z),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a(e(ja),null,{default:t(()=>[(l(!0),v(Z,null,K(I.rows,(z,$)=>(l(),_(e(ke),{key:`weekDate-${$}`,class:"mt-2 w-full"},{default:t(()=>[(l(!0),v(Z,null,K(z,S=>(l(),_(e(Ia),{key:S.toString(),date:S},{default:t(()=>[a(e(Oa),{day:S,month:I.value},null,8,["day","month"])]),_:2},1032,["date"]))),128))]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))])]),_:1},16,["class"]))}}),Ia=x({__name:"CalendarCell",props:{date:{},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(Je),w({class:e(E)("relative h-9 w-9 p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([data-selected])]:rounded-md [&:has([data-selected])]:bg-accent [&:has([data-selected][data-outside-view])]:bg-accent/50",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Oa=x({__name:"CalendarCellTrigger",props:{day:{},month:{},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(Qe),w({class:e(E)(e(ue)({variant:"ghost"}),"h-9 w-9 p-0 font-normal","[&[data-today]:not([data-selected])]:bg-accent [&[data-today]:not([data-selected])]:text-accent-foreground","data-[selected]:bg-primary data-[selected]:text-primary-foreground data-[selected]:opacity-100 data-[selected]:hover:bg-primary data-[selected]:hover:text-primary-foreground data-[selected]:focus:bg-primary data-[selected]:focus:text-primary-foreground","data-[disabled]:text-muted-foreground data-[disabled]:opacity-50","data-[unavailable]:text-destructive-foreground data-[unavailable]:line-through","data-[outside-view]:text-muted-foreground data-[outside-view]:opacity-50 [&[data-outside-view][data-selected]]:bg-accent/50 [&[data-outside-view][data-selected]]:text-muted-foreground [&[data-outside-view][data-selected]]:opacity-30",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ha=x({__name:"CalendarGrid",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(ea),w({class:e(E)("w-full border-collapse space-y-1",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),ja=x({__name:"CalendarGridBody",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(o,c)=>(l(),_(e(aa),Q(se(s)),{default:t(()=>[F(o.$slots,"default")]),_:3},16))}}),Ga=x({__name:"CalendarGridHead",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(o,c)=>(l(),_(e(ta),Q(se(s)),{default:t(()=>[F(o.$slots,"default")]),_:3},16))}}),ke=x({__name:"CalendarGridRow",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(sa),w({class:e(E)("flex",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Wa=x({__name:"CalendarHeadCell",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(la),w({class:e(E)("w-9 rounded-md text-[0.8rem] font-normal text-muted-foreground",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Ka=x({__name:"CalendarHeader",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(oa),w({class:e(E)("relative flex w-full items-center justify-between pt-1",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default")]),_:3},16,["class"]))}}),Za=x({__name:"CalendarHeading",props:{asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(na),w({class:e(E)("text-sm font-medium",s.class)},e(c)),{default:t(({headingValue:d})=>[F(r.$slots,"default",{headingValue:d},()=>[b(J(d),1)])]),_:3},16,["class"]))}}),Xa=x({__name:"CalendarNextButton",props:{step:{},nextPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(ra),w({class:e(E)(e(ue)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default",{},()=>[a(e(Va),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ya=x({__name:"CalendarPrevButton",props:{step:{},prevPage:{type:Function},asChild:{type:Boolean},as:{},class:{}},setup(i){const s=i,o=B(()=>{const{class:r,...u}=s;return u}),c=H(o);return(r,u)=>(l(),_(e(ia),w({class:e(E)(e(ue)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100",s.class)},e(c)),{default:t(()=>[F(r.$slots,"default",{},()=>[a(e(za),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Ja=x({__name:"Popover",props:{defaultOpen:{type:Boolean},open:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(i,{emit:s}){const r=ie(i,s);return(u,d)=>(l(),_(e(ua),Q(se(e(r))),{default:t(()=>[F(u.$slots,"default")]),_:3},16))}}),Qa=x({__name:"PopoverTrigger",props:{asChild:{type:Boolean},as:{}},setup(i){const s=i;return(o,c)=>(l(),_(e(da),Q(se(s)),{default:t(()=>[F(o.$slots,"default")]),_:3},16))}}),et=x({inheritAttrs:!1,__name:"PopoverContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},side:{},sideOffset:{default:4},align:{default:"center"},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(i,{emit:s}){const o=i,c=s,r=B(()=>{const{class:d,...C}=o;return C}),u=ie(r,c);return(d,C)=>(l(),_(e(fa),null,{default:t(()=>[a(e(ca),w({...e(u),...d.$attrs},{class:e(E)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",o.class)}),{default:t(()=>[F(d.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),at=async()=>{const{data:i,error:s}=await re.from("lotteries").select("*");if(s)throw new Error(s.message);return i},tt=["aria-disabled"],st=["disabled"],lt=p("input",{hidden:""},null,-1),ot=p("span",null,"Cancelar",-1),nt=p("span",null,"Crear",-1),rt=x({__name:"DrawForm",emits:["submit","success","error","cancel"],setup(i,{emit:s}){const o=T("idle"),c=T([]),r=s,u=B(()=>o.value==="pending"),d=B(()=>o.value==="pending"||u.value),C=new ma("es-CO",{dateStyle:"long"}),G=De(P.object({lottery_id:P.string({required_error:"Lotería es requerida"}).refine(y=>{var V;return(V=c.value)==null?void 0:V.some(j=>j.id.toString()===y)},{message:"El Sorteo no existe"}),name:P.string().refine(y=>y,{message:"La descripción es requerida"}),drawn_at:P.string().refine(y=>y,{message:"La fecha es requerida"})})),{handleSubmit:W,setFieldValue:I,values:z}=Ee({validationSchema:G,initialValues:{}}),$=B({get:()=>z.drawn_at?va(z.drawn_at):void 0,set:y=>y}),S=()=>{at().then(y=>{c.value=y}).catch(y=>{console.error(y)}).finally(()=>{})},X=W(y=>{o.value="pending",Ea({...y,lottery_id:parseInt(y.lottery_id)}).then(async V=>{o.value="success",r("success",V==null?void 0:V.id)}).catch(()=>{o.value="error"}).finally(()=>{setTimeout(()=>{o.value="idle"},1e3)})}),L=()=>{r("cancel")};return pa($,y=>{y&&(!z.name||z.name.startsWith("Sorteo del "))&&I("name",`Sorteo del ${C.format(ve(y))}`)}),de(async()=>{S()}),(y,V)=>{const j=ce("auto-animate");return l(),v("form",{onSubmit:V[2]||(V[2]=Ve((...N)=>e(X)&&e(X)(...N),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":d.value},[p("fieldset",{disabled:d.value},[a(e(A),{name:"lottery_id"},{default:t(({componentField:N})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Lotería")]),_:1}),a(e(Ne),Q(se(N)),{default:t(()=>[a(e(M),null,{default:t(()=>[a(e(qe),null,{default:t(()=>[a(e(Le),{placeholder:"Elige una loteria"})]),_:1})]),_:1}),a(e(Re),null,{default:t(()=>[a(e(Me),null,{default:t(()=>[a(e(Ue),null,{default:t(()=>[b("Loterías")]),_:1}),(l(!0),v(Z,null,K(c.value,ee=>(l(),_(e(Ae),{key:ee.id,value:ee.id.toString()},{default:t(()=>[b(J(ee.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040),k((l(),v("div",null,[a(e(U))])),[[j]])]),_:2},1024)]),_:1}),a(e(A),{name:"name"},{default:t(({componentField:N})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Descripción del sorteo")]),_:1}),a(e(M),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Descripción corta del sorteo"},N,{required:""}),null,16)]),_:2},1024),a(e(xe),null,{default:t(()=>[b(' Descripción corta del sorteo, e.j. "Sorteo del 10 de Mayo de 2024". ')]),_:1}),k((l(),v("div",null,[a(e(U))])),[[j]])]),_:2},1024)]),_:1}),a(e(A),{name:"drawn_at"},{default:t(()=>[a(e(D),{class:"flex flex-col"},{default:t(()=>[a(e(R),null,{default:t(()=>[b("Fecha del sorteo")]),_:1}),a(e(Ja),null,{default:t(()=>[a(e(Qa),{"as-child":""},{default:t(()=>[a(e(M),null,{default:t(()=>[a(e(O),{variant:"outline",class:le(e(E)("w-full ps-3 text-start font-normal",!$.value&&"text-muted-foreground"))},{default:t(()=>[p("span",null,J($.value?e(C).format(e(ve)($.value)):"Seleccione una fecha"),1),a(e(Fa),{class:"ms-auto h-4 w-4 opacity-50"})]),_:1},8,["class"]),lt]),_:1})]),_:1}),a(e(et),{class:"w-auto p-0"},{default:t(()=>[a(e(Ta),{modelValue:$.value,"onUpdate:modelValue":[V[0]||(V[0]=N=>$.value=N),V[1]||(V[1]=N=>{N?e(I)("drawn_at",N.toString()):e(I)("drawn_at",void 0)})],"calendar-label":"Date of birth","initial-focus":"","min-value":e(_a)(e(ha)())},null,8,["modelValue","min-value"])]),_:1})]),_:1}),a(e(xe),null,{default:t(()=>[b(" Fecha del sorteo. ")]),_:1}),k((l(),v("div",null,[a(e(U))])),[[j]])]),_:1})]),_:1}),a(e(D),{class:"flex w-full flex-col-reverse items-center justify-end gap-2 space-y-0 py-2 md:flex-row"},{default:t(()=>[a(e(O),{type:"button",class:"w-full gap-2 @xl/form:w-auto",variant:"outline",onClick:L},{default:t(()=>[ot]),_:1}),k((l(),_(e(O),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[u.value?(l(),_(e(fe),{key:0,class:"h-6 w-6"})):(l(),_(e(Y),{key:1,class:"h-6 w-6"})),nt]),_:1})),[[j]])]),_:1})],8,st)],40,tt)}}}),it=["aria-disabled"],ut=["disabled"],dt={class:"flex flex-row gap-2"},ct={key:0,class:"p-4",value:""},ft={class:"grid gap-4 sm:grid-cols-2 sm:gap-6"},mt={class:"col-span-2 flex flex-col gap-4 rounded-md border p-4"},pt={class:"flex gap-2 text-lg font-medium"},_t=p("span",null,"Premios",-1),ht=["onClick"],vt={class:"w-full rounded-md border p-4"},gt={class:"text-lg font-medium"},bt={class:"flex w-full flex-row items-center justify-end py-2"},yt=p("span",null,"Agregar premio",-1),wt=p("span",null,"Crear",-1),Ce=1,Se=5e6,xt=x({__name:"RaffleForm",props:ge({withoutActions:{type:[Boolean,String],default:!1}},{isSubmiting:{type:Boolean,required:!1,default:!1},isSubmitingModifiers:{}}),emits:ge(["success"],["update:isSubmiting"]),setup(i,{emit:s}){const o=["image/jpeg","image/jpg","image/png","image/webp"],c=i,r=ga(i,"isSubmiting"),u=T([]),d=T({draw_id:void 0,name:"",description:"",image_path:null,thumb_hash:null,number_of_tickets:1e3,ticket_price:"",prizes:[{key:be().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null}]}),C=ba(async()=>await $e()),G=ya(()=>{C.clear()},3e4),W=P.object({draw_id:P.string({required_error:"Sorteo es requerido"}).refine(async n=>{try{G()}catch(f){console.error(f)}return await C().then(f=>f==null?void 0:f.some(h=>h.id.toString()===n))},{message:"El Sorteo no existe"}),name:P.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),description:P.string({required_error:"La descripción es requerida"}).min(3,{message:"La descripción debe tener al menos 3 caracteres"}).optional(),number_of_tickets:P.number({required_error:"El numero de tickets es requerido"}).min(100,{message:"El numero de tickets debe ser mayor o igual a 100"}),ticket_price:P.string({required_error:"El valor es requerido"}).transform(n=>parseFloat(n)).refine(n=>!isNaN(n)&&n>=1,{message:"El valor debe ser un número mayor o igual a 1"}),prizes:P.array(P.object({name:P.string({required_error:"Nombre es requerido"}).min(3,{message:"Nombre debe tener al menos 3 caracteres"}),prize_value:P.string({required_error:"El valor es requerido"}).transform(n=>parseFloat(n)).refine(n=>!isNaN(n)&&n>=1,{message:"El valor debe ser un número mayor o igual a 1"}),image:P.instanceof(File).refine(n=>n instanceof File,{message:"Debe seleccionar una imagen"}).refine(n=>o.includes(n.type),{message:"Tipo de archivo no aceptado"}).refine(n=>n.size>=Ce,{message:"El archivo está vacío"}).refine(n=>n.size<=Se,{message:"El archivo es demasiado grande"})})).min(1),image:P.instanceof(File).refine(n=>n instanceof File,{message:"Debe seleccionar una imagen"}).refine(n=>o.includes(n.type),{message:"Tipo de archivo no aceptado"}).refine(n=>n.size>=Ce,{message:"El archivo está vació"}).refine(n=>n.size<=Se,{message:"El archivo es demasiado grande"})}),I=De(W),z=Ee({validationSchema:I,initialValues:{number_of_tickets:d.value.number_of_tickets}}),$=s,S=()=>{d.value.prizes.push({key:be().slice(-10),name:"",prize_value:"",image:null,thumb_hash:null})},X=n=>{d.value.prizes.length>1&&d.value.prizes.find(h=>h.key===n)&&(d.value.prizes=d.value.prizes.filter(h=>h.key!==n))},L=async n=>{const f=await $a(n,n.name,"covers");return f==null?void 0:f.fullPath},y=n=>new Promise((f,h)=>{L(n.image).then(m=>{f({draw_id:parseInt(n.draw_id),name:n.name,description:n.description,image_path:m,thumb_hash:d.value.thumb_hash,number_of_tickets:n.number_of_tickets,ticket_price:n.ticket_price})}).catch(m=>{h(m)})}),V=n=>Promise.all(n.prizes.map((f,h)=>new Promise((m,g)=>{L(f.image).then(q=>{m({name:f.name,prize_value:f.prize_value,image_path:q,thumb_hash:d.value.prizes[h].thumb_hash})}).catch(q=>{g(q)})}))),j=n=>new Promise((f,h)=>{y(n).then(m=>{V(n).then(g=>{f({...m,prizes:g})}).catch(g=>{h(g)})}).catch(m=>{h(m)})}),N=z.handleSubmit(async n=>{r.value=!0,z.setErrors({}),r.value=!1;const f=await j(n);je(f).then(()=>{$("success")}).catch(h=>{console.error(h)}).finally(()=>{r.value=!1})},({errors:n})=>{const f=Object.keys(n)[0].replace("[",".").replace("]",""),h=document.querySelector(`[name="${f}"]`);h&&h.scrollIntoView({behavior:"smooth",block:"center"})}),ee=B(()=>c.withoutActions===""||c.withoutActions===!0),oe=T(!1),pe=()=>{oe.value=!1},Ie=async n=>{pe(),await _e(),d.value.draw_id=n.toString()},_e=async()=>{r.value=!0,await $e().then(n=>u.value=n).finally(()=>r.value=!1)};return de(async()=>{await _e()}),(n,f)=>{const h=ce("auto-animate");return l(),v("form",{onSubmit:f[6]||(f[6]=Ve((...m)=>e(N)&&e(N)(...m),["prevent"])),class:"flex w-full flex-col gap-2 @container/form","aria-disabled":r.value},[p("fieldset",{disabled:r.value},[a(e(A),{name:"name"},{default:t(({componentField:m})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Nombre")]),_:1}),a(e(M),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre de la Rifa"},m,{"model-value":d.value.name,"onUpdate:modelValue":f[0]||(f[0]=g=>d.value.name=g),required:""}),null,16,["model-value"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),a(e(A),{name:"draw_id"},{default:t(({componentField:m})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Sorteo")]),_:1}),a(e(Ne),w(m,{"model-value":d.value.draw_id,"onUpdate:modelValue":f[2]||(f[2]=g=>d.value.draw_id=g)}),{default:t(()=>[a(e(M),null,{default:t(()=>[p("div",dt,[a(e(qe),null,{default:t(()=>[a(e(Le),{placeholder:"Elige un sorteo"})]),_:1}),a(e(Pe),{open:oe.value,"onUpdate:open":f[1]||(f[1]=g=>oe.value=g)},{default:t(()=>[a(e(Te),{"as-child":""},{default:t(()=>[a(e(O),{variant:"outline",type:"button"},{default:t(()=>[a(e(Y),{class:"h-6 w-6"})]),_:1})]),_:1}),a(e(Be),null,{default:t(()=>[a(e(Fe),null,{default:t(()=>[a(e(ze),null,{default:t(()=>[b("Crear nuevo sorteo")]),_:1}),a(rt,{onSuccess:Ie,onCancel:pe})]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1}),a(e(Re),null,{default:t(()=>[a(e(Me),null,{default:t(()=>[a(e(Ue),null,{default:t(()=>[b("Sorteos")]),_:1}),u.value.length===0?(l(),v("div",ct,"No hay sorteos")):ne("",!0),(l(!0),v(Z,null,K(u.value,g=>(l(),_(e(Ae),{key:g.id,value:g.id.toString()},{default:t(()=>[b(J(g.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:2},1040,["model-value"]),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),a(e(A),{name:"description"},{default:t(({componentField:m})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Descripción")]),_:1}),a(e(M),null,{default:t(()=>[a(e(Ua),w({type:"text",placeholder:"Descripción de la Rifa"},m,{"model-value":d.value.description,"onUpdate:modelValue":f[3]||(f[3]=g=>d.value.description=g)}),null,16,["model-value"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),a(e(A),{name:"number_of_tickets"},{default:t(({componentField:m})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Número de Bonos:")]),_:1}),a(e(M),null,{default:t(()=>[a(e(te),w({type:"number",inputmode:"numeric",placeholder:"Nombre de la Rifa"},m,{"model-value":d.value.number_of_tickets,"onUpdate:modelValue":f[4]||(f[4]=g=>d.value.number_of_tickets=g),required:""}),null,16,["model-value"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),a(e(A),{name:"ticket_price"},{default:t(({value:m,handleChange:g})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Costo del Bono")]),_:1}),a(e(M),null,{default:t(()=>[a(we,{"model-value":m,"onUpdate:modelValue":q=>{g(q,!0),d.value.ticket_price=q.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),a(e(A),{name:"image"},{default:t(({componentField:m})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Portada de la rifa")]),_:1}),a(e(M),null,{default:t(()=>[a(ye,w(m,{base64ThumbHash:d.value.thumb_hash,"onUpdate:base64ThumbHash":f[5]||(f[5]=g=>d.value.thumb_hash=g)}),null,16,["base64ThumbHash"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:1}),p("div",ft,[k((l(),v("fieldset",mt,[p("legend",pt,[a(e(ka),{class:"h-8 w-8"}),_t]),(l(!0),v(Z,null,K(d.value.prizes,(m,g)=>(l(),v("div",{class:"relative w-full",key:m.key},[d.value.prizes.length>1?(l(),v("button",{key:0,type:"button",class:"absolute right-0 top-0 rounded-xl bg-background",onClick:q=>X(m.key)},[a(e(Ma),{class:"h-8 w-8"})],8,ht)):ne("",!0),p("fieldset",vt,[p("legend",gt,"Premio "+J(g+1),1),a(e(A),{name:"prizes."+g+".name"},{default:t(({componentField:q})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Nombre")]),_:1}),a(e(M),null,{default:t(()=>[a(e(te),w({type:"text",placeholder:"Nombre del premio",ref_for:!0},q,{"model-value":m.name,"onUpdate:modelValue":ae=>m.name=ae,required:""}),null,16,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(A),{name:"prizes."+g+".prize_value"},{default:t(({value:q,handleChange:ae})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Valor del premio")]),_:1}),a(e(M),null,{default:t(()=>[a(we,{"model-value":q,"onUpdate:modelValue":he=>{ae(he,!0),m.prize_value=he.toString()},required:""},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:2},1032,["name"]),a(e(A),{name:"prizes."+g+".image"},{default:t(({componentField:q})=>[a(e(D),null,{default:t(()=>[a(e(R),null,{default:t(()=>[b("Imagen")]),_:1}),a(e(M),null,{default:t(()=>[a(ye,w({ref_for:!0},q,{base64ThumbHash:m.thumb_hash,"onUpdate:base64ThumbHash":ae=>m.thumb_hash=ae}),null,16,["base64ThumbHash","onUpdate:base64ThumbHash"])]),_:2},1024),k((l(),v("div",null,[a(e(U))])),[[h]])]),_:2},1024)]),_:2},1032,["name"])])]))),128)),p("div",bt,[a(e(O),{variant:"outline",type:"button",class:"w-full gap-2 @xl/form:w-auto",onClick:S},{default:t(()=>[a(e(Y),{class:"h-6 w-6"}),yt]),_:1})])])),[[h]])]),ee.value?ne("",!0):F(n.$slots,"actions",Q(w({key:0},{isSubmiting:r.value})),()=>[a(e(D),{class:"flex w-full flex-row items-center justify-end py-2"},{default:t(()=>[k((l(),_(e(O),{type:"submit",class:"w-full gap-2 @xl/form:w-auto"},{default:t(()=>[r.value?(l(),_(e(fe),{key:0,class:"h-6 w-6"})):(l(),_(e(Y),{key:1,class:"h-6 w-6"})),wt]),_:1})),[[h]])]),_:1})])],8,ut)],40,it)}}}),$t={class:"flex w-full flex-col items-center"},kt={class:"flex w-full max-w-3xl flex-col gap-4"},Ct={class:"relative grow"},St=p("span",{class:"hidden md:inline"},"Nueva rifa",-1),Pt={class:"flex flex-row items-center justify-start gap-2"},Bt=p("span",null," Nueva Rifa ",-1),Ft={class:"relative overflow-y-auto px-6 py-4"},zt=p("span",null,"Crear",-1),Vt={class:"flex w-full flex-col items-center gap-4"},Dt=p("div",{class:"flex w-full flex-col items-center"},null,-1),as=x({__name:"HomeView",setup(i){const s=T(!1),o=T(!1),c=T(""),r=T([]),u=T(!1),d=T(!1),C=T(null),G=B(()=>r.value.filter($=>$.raffle_name.toLowerCase().includes(c.value.toLowerCase())));wa(C,([{isIntersecting:$}])=>{d.value=!$},{rootMargin:"-65px",threshold:1});const W=()=>{u.value=!1},I=async()=>{W(),await z()},z=async()=>{s.value=!0,await Ge().then($=>{r.value=$}).catch($=>{console.log($)}).finally(()=>{s.value=!1})};return de(async()=>{await z()}),($,S)=>{const X=ce("auto-animate");return l(),v("div",$t,[p("div",{ref_key:"sentinal",ref:C,class:"h-0 w-full"},null,512),p("div",kt,[p("div",{class:le(["sticky top-16 z-10 flex flex-row gap-4 rounded-lg border bg-background-elevated/90 px-4 py-3 backdrop-blur transition-all duration-300",{"-mx-4 rounded-none border-x-0 border-t-0 !bg-background/90 @3xl/main:rounded-b-lg @3xl/main:border-x @3xl/main:!bg-background-elevated/90":d.value}])},[p("div",Ct,[a(e(Ca),{class:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2"}),a(te,{type:"text",modelValue:c.value,"onUpdate:modelValue":S[0]||(S[0]=L=>c.value=L),autocomplete:"off",placeholder:"Buscar",class:"w-full py-2 pl-11 pr-4 text-sm"},null,8,["modelValue"])]),a(e(Pe),{open:u.value,"onUpdate:open":S[3]||(S[3]=L=>u.value=L)},{default:t(()=>[a(e(Te),{asChild:""},{default:t(()=>[a(e(O),{class:"gap-2"},{default:t(()=>[a(e(Y),{class:"h-5 w-5"}),St]),_:1})]),_:1}),a(e(Be),{onEscapeKeyDown:S[2]||(S[2]=L=>L.preventDefault()),class:"max-h-[calc(100dvh-2rem)] w-[calc(100vw-2rem)] max-w-2xl grid-rows-[auto_minmax(0,1fr)_auto] gap-0 rounded-lg p-0 transition-[opacity,_transform]"},{default:t(()=>[a(e(Fe),{class:"border-b p-6 pb-4"},{default:t(()=>[a(e(ze),null,{default:t(()=>[p("div",Pt,[a(e(Sa),{class:"h-8 w-8"}),Bt])]),_:1}),a(e(He),null,{default:t(()=>[b(" Crea una nueva rifa ")]),_:1})]),_:1}),p("div",Ft,[a(xt,{withoutActions:"",id:"raffle-form",isSubmiting:o.value,"onUpdate:isSubmiting":S[1]||(S[1]=L=>o.value=L),onSuccess:I},null,8,["isSubmiting"])]),a(e(Pa),{class:"gap-2 border-t p-6 pt-4"},{default:t(()=>[a(e(Ba),{"as-child":""},{default:t(()=>[a(e(O),{variant:"secondary",type:"button",disabled:o.value},{default:t(()=>[b("Cancelar")]),_:1},8,["disabled"])]),_:1}),k((l(),_(e(O),{class:"gap-3",form:"raffle-form",type:"submit",disabled:o.value},{default:t(()=>[o.value?(l(),_(e(fe),{key:0,class:"h-6 w-6"})):(l(),_(e(Y),{key:1,class:"h-6 w-6"})),zt]),_:1},8,["disabled"])),[[X]])]),_:1})]),_:1})]),_:1},8,["open"])],2),p("div",Vt,[a(Oe,{raffles:G.value,loading:s.value},null,8,["raffles","loading"])])]),Dt])}}});export{as as default};
