import{M as i,X as u}from"./index-YeJzIK-I.js";const z=async()=>{const{data:e,error:r}=await i.from("raffle_stats").select("*, prizes(*)").order("raffle_id",{ascending:!0});if(r)throw new Error(r.message);return e},w=async e=>{const{data:r,error:t}=await i.from("prizes").select("*").eq("raffle_id",e).order("id",{ascending:!0});if(t)throw new Error(t.message);return r},b=async e=>{const{data:r,error:t}=await i.from("raffles").select("*").eq("id",e).single();if(t)throw new Error(t.message);return r},y=async e=>{const{prizes:r,...t}=e,o=JSON.parse(JSON.stringify(t)),a=JSON.parse(JSON.stringify(r)),{data:n,error:c}=await i.rpc("create_raffle_with_prizes",{raffle_data:o,prizes_data:a});if(console.log({data:n,error:c}),c)throw c;return n},N=async e=>{const{data:r,error:t}=await i.from("raffles").update({draw_id:e.draw_id,name:e.name,description:e.description,image_path:e.image_path,thumb_hash:e.thumb_hash}).eq("id",e.id).select().single();if(t)throw t;const o=await w(e.id),a=e.prizes.filter(s=>s.id!==void 0),n=o.filter(s=>!a.map(p=>Number(p.id)).includes(Number(s.id))),c=e.prizes.filter(s=>!a.includes(s)),{error:f}=await i.from("prizes").delete().in("id",n.map(s=>s.id));if(f)throw f;const{error:d}=await i.from("prizes").insert(c.map(s=>({name:s.name,raffle_id:e.id,prize_value:s.prize_value,image_path:s.image_path,thumb_hash:s.thumb_hash})));if(d)throw d;const{error:l}=await i.from("prizes").upsert(a);if(l)throw l;return r},P=async e=>{const{data:r,error:t}=await i.rpc("delete_raffle_and_associated_data",{p_raffle_id:e});if(t)throw t;return r},R=async(e,r,t)=>{const{data:o,error:a}=await i.from("raffles_sellers").insert({raffle_id:e,seller_id:r,ticket_price:t}).select();if(a)throw a;return o};const m=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const _=({size:e,strokeWidth:r=2,absoluteStrokeWidth:t,color:o,iconNode:a,name:n,class:c,...f},{slots:d})=>u("svg",{...h,width:e||h.width,height:e||h.height,stroke:o||h.stroke,"stroke-width":t?Number(r)*24/Number(e):r,class:["lucide",`lucide-${m(n??"icon")}`],...f},[...a.map(l=>u(...l)),...d.default?[d.default()]:[]]);const v=(e,r)=>(t,{slots:o})=>u(_,{...t,iconNode:r,name:e},o);export{b as a,R as b,v as c,y as d,P as e,z as g,N as u};
